import{a as ft}from"./chunk-TACFUCLO.js";import{a as Ct}from"./chunk-CWC3JZKL.js";import{a as U}from"./chunk-LY455BIY.js";import{a as gt}from"./chunk-5VHOJUVT.js";import{f as mt,h as pt}from"./chunk-RO3D7PJV.js";import{a as ut,b as j,c as G,d as xt,f as z,g as J,h as H,i as Q}from"./chunk-AEYFKSCU.js";import{a as st}from"./chunk-SJQBYHCF.js";import{$a as W,Eb as Z,Fa as lt,Ia as B,Na as m,R as ot,Sb as q,Ub as _t,Vb as dt,Wa as b,Wb as O,X as M,Ya as p,Za as k,_a as $,a as K,ab as l,b as X,bb as r,cb as s,da as u,db as P,ea as x,eb as E,f as nt,fb as _,hb as c,ib as F,ja as at,jb as I,kb as rt,mb as ct,nb as f,ob as g,pb as v,rb as L,sb as D,tb as N,ub as T,vb as V,za as d}from"./chunk-K6DX3A3E.js";var A=class n{http=M(st);#t=lt({loading:!0,planificacion:[]});planificacion=Z(()=>this.#t().planificacion);loading=Z(()=>this.#t().loading);ruta="https://mysticconnectserver-production.up.railway.app/api";constructor(){this.cargarPlanificacion()}cargarPlanificacion(){this.http.get(`${this.ruta}/planificacion`).subscribe(a=>{this.#t.set({loading:!1,planificacion:a})})}NuevaPlanificacion=a=>nt(this,null,function*(){this.#t.set(X(K({},this.#t()),{loading:!0})),this.http.post(`${this.ruta}/planificacion`,a).subscribe(t=>{this.#t.set(X(K({},this.#t()),{loading:!1,planificacion:[...this.#t().planificacion,t]}))})});static \u0275fac=function(t){return new(t||n)};static \u0275prov=ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var Et=n=>({"is-active":n}),Ft=()=>[];function Pt(n,a){n&1&&s(0,"app-loadings")}function yt(n,a){if(n&1){let t=P();l(0,"div",11)(1,"label",12),c(2,"\xA0"),r(),l(3,"button",35),E("click",function(){u(t);let i=_(2).$index,e=_(2);return x(e.removeMeta(i))}),l(4,"span",33),s(5,"i",36),r()()()}}function wt(n,a){if(n&1){let t=P();l(0,"div",11)(1,"label",12),c(2,"\xA0"),r(),l(3,"button",8),E("click",function(){u(t);let i=_(3);return x(i.addMeta())}),l(4,"span",33),s(5,"i",34),r()()(),m(6,yt,6,0,"div",11)}if(n&2){let t=_().$index;d(6),p(t>0?6:-1)}}function Mt(n,a){if(n&1){let t=P();l(0,"div",10)(1,"div",11)(2,"label",12),c(3,"de (puntos)"),r(),l(4,"input",32),v("ngModelChange",function(i){let e=u(t).$index,C=_(2);return g(C.data.incentivos[e].de,i)||(C.data.incentivos[e].de=i),x(i)}),r()(),l(5,"div",11)(6,"label",12),c(7,"hasta (puntos)"),r(),l(8,"input",32),v("ngModelChange",function(i){let e=u(t).$index,C=_(2);return g(C.data.incentivos[e].hasta,i)||(C.data.incentivos[e].hasta=i),x(i)}),r()(),l(9,"div",11)(10,"label",12),c(11,"Incentivo (USD)"),r(),l(12,"input",32),v("ngModelChange",function(i){let e=u(t).$index,C=_(2);return g(C.data.incentivos[e].incentivo,i)||(C.data.incentivos[e].incentivo=i),x(i)}),r()(),m(13,wt,7,1),r()}if(n&2){let t=a.$index,o=_(2);d(4),f("ngModel",o.data.incentivos[t].de),d(4),f("ngModel",o.data.incentivos[t].hasta),d(4),f("ngModel",o.data.incentivos[t].incentivo),d(),p(t===o.metas-1?13:-1)}}function Tt(n,a){if(n&1){let t=P();l(0,"span",9),c(1,"Plan mensual"),r(),s(2,"hr"),l(3,"div",10)(4,"div",11)(5,"label",12),c(6,"Mes"),r(),l(7,"div",13)(8,"select",14),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.mes,i)||(e.data.mes=i),x(i)}),l(9,"option",15),c(10,"Enero"),r(),l(11,"option",16),c(12,"Febrero"),r(),l(13,"option",17),c(14,"Marzo"),r(),l(15,"option",18),c(16,"Abril"),r(),l(17,"option",19),c(18,"Mayo"),r(),l(19,"option",20),c(20,"Junio"),r(),l(21,"option",21),c(22,"Julio"),r(),l(23,"option",22),c(24,"Agosto"),r(),l(25,"option",23),c(26,"Septiembre"),r(),l(27,"option",24),c(28,"Octubre"),r(),l(29,"option",25),c(30,"Noviembre"),r(),l(31,"option",26),c(32,"Diciembre"),r()()()(),l(33,"div",11)(34,"label",12),c(35,"Inicio"),r(),l(36,"input",27),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.inicio,i)||(e.data.inicio=i),x(i)}),r()(),l(37,"div",11)(38,"label",12),c(39,"Cierre"),r(),l(40,"input",27),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.cierre,i)||(e.data.cierre=i),x(i)}),r()()(),s(41,"hr"),l(42,"span",28),c(43,"Metas"),r(),s(44,"br")(45,"br"),l(46,"div",29)(47,"div",30)(48,"span",31),c(49,"Mystic (Linea tradicional)"),r(),l(50,"div",10)(51,"div",11)(52,"label",12),c(53,"Impulso (Semanal)"),r(),l(54,"input",32),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.metas.tradicional.mystic.impulso,i)||(e.data.metas.tradicional.mystic.impulso=i),x(i)}),r()(),l(55,"div",11)(56,"label",12),c(57,"Evento"),r(),l(58,"input",32),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.metas.tradicional.mystic.evento,i)||(e.data.metas.tradicional.mystic.evento=i),x(i)}),r()()(),l(59,"span",31),c(60,"Qerametik (Linea tradicional)"),r(),l(61,"div",10)(62,"div",11)(63,"label",12),c(64,"Impulso (Semanal)"),r(),l(65,"input",32),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.metas.tradicional.qerametik.impulso,i)||(e.data.metas.tradicional.qerametik.impulso=i),x(i)}),r()(),l(66,"div",11)(67,"label",12),c(68,"Evento"),r(),l(69,"input",32),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.metas.tradicional.qerametik.evento,i)||(e.data.metas.tradicional.qerametik.evento=i),x(i)}),r()()()(),l(70,"div",30)(71,"span",31),c(72,"Mystic (Rebranding)"),r(),l(73,"div",10)(74,"div",11)(75,"label",12),c(76,"Impulso (Semanal)"),r(),l(77,"input",32),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.metas.rebranding.mystic.impulso,i)||(e.data.metas.rebranding.mystic.impulso=i),x(i)}),r()(),l(78,"div",11)(79,"label",12),c(80,"Evento"),r(),l(81,"input",32),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.metas.rebranding.mystic.evento,i)||(e.data.metas.rebranding.mystic.evento=i),x(i)}),r()()(),l(82,"span",31),c(83,"Qerametik (Rebranding)"),r(),l(84,"div",10)(85,"div",11)(86,"label",12),c(87,"Impulso (Semanal)"),r(),l(88,"input",32),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.metas.rebranding.qerametik.impulso,i)||(e.data.metas.rebranding.qerametik.impulso=i),x(i)}),r()(),l(89,"div",11)(90,"label",12),c(91,"Evento"),r(),l(92,"input",32),v("ngModelChange",function(i){u(t);let e=_();return g(e.data.metas.rebranding.qerametik.evento,i)||(e.data.metas.rebranding.qerametik.evento=i),x(i)}),r()()()()(),s(93,"hr"),l(94,"span",28),c(95," Incentivos por ventas "),r(),s(96,"br")(97,"br"),$(98,Mt,14,4,"div",10,k),s(100,"br")}if(n&2){let t=_();d(8),f("ngModel",t.data.mes),d(28),f("ngModel",t.data.inicio),d(4),f("ngModel",t.data.cierre),d(14),f("ngModel",t.data.metas.tradicional.mystic.impulso),d(4),f("ngModel",t.data.metas.tradicional.mystic.evento),d(7),f("ngModel",t.data.metas.tradicional.qerametik.impulso),d(4),f("ngModel",t.data.metas.tradicional.qerametik.evento),d(8),f("ngModel",t.data.metas.rebranding.mystic.impulso),d(4),f("ngModel",t.data.metas.rebranding.mystic.evento),d(7),f("ngModel",t.data.metas.rebranding.qerametik.impulso),d(4),f("ngModel",t.data.metas.rebranding.qerametik.evento),d(6),W(L(11,Ft).constructor(t.metas))}}var Y=class n{servicePlanificacion=M(A);active;onCloseModal=new at;metas=1;data={mes:"",inicio:"",cierre:"",metas:{tradicional:{mystic:{impulso:0,evento:0},qerametik:{impulso:0,evento:0}},rebranding:{mystic:{impulso:0,evento:0},qerametik:{impulso:0,evento:0}}},incentivos:[{de:0,hasta:0,incentivo:0}]};cerrar(){this.onCloseModal.emit()}addMeta(){this.metas++,this.data.incentivos.push({de:0,hasta:0,incentivo:0})}removeMeta(a){this.metas--,this.data.incentivos.length>1&&this.data.incentivos.splice(a,1)}sumarMetas(){this.metas++}crearPlanificacion(){this.servicePlanificacion.NuevaPlanificacion(this.data),this.metas=1,this.data={mes:"",inicio:"",cierre:"",metas:{tradicional:{mystic:{impulso:0,evento:0},qerametik:{impulso:0,evento:0}},rebranding:{mystic:{impulso:0,evento:0},qerametik:{impulso:0,evento:0}}},incentivos:[{de:0,hasta:0,incentivo:0}]},this.cerrar()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=B({type:n,selectors:[["app-planificacion"]],inputs:{active:"active"},outputs:{onCloseModal:"onCloseModal"},decls:15,vars:4,consts:[[1,"modal",3,"ngClass"],[1,"modal-background"],[1,"modal-card",2,"width","70%"],[1,"modal-card-head"],[1,"modal-card-title"],["aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"banner"],[1,"button","is-success",3,"click"],[2,"font-size","xx-large"],[1,"field","is-grouped"],[1,"control"],["for","",1,"label"],[1,"select"],[3,"ngModelChange","ngModel"],["value","Enero"],["value","Febrero"],["value","Marzo"],["value","Abril"],["value","Mayo"],["value","Junio"],["value","Julio"],["value","Agosto"],["value","Septiembre"],["value","Octubre"],["value","Noviembre"],["value","Diciembre"],["type","date","name","","id","",1,"input",3,"ngModelChange","ngModel"],[2,"font-size","x-large"],[1,"columns"],[1,"column"],[2,"font-weight","bolder"],["type","number","name","","id","",1,"input",3,"ngModelChange","ngModel"],[1,"icon"],[1,"fas","fa-plus"],[1,"button","is-danger",3,"click"],[1,"fas","fa-minus"]],template:function(t,o){t&1&&(l(0,"div",0),s(1,"div",1),l(2,"div",2)(3,"header",3)(4,"p",4),c(5,"Planificaci\xF3n"),r(),l(6,"button",5),E("click",function(){return o.cerrar()}),r()(),l(7,"div",6)(8,"div",7),m(9,Pt,1,0,"app-loadings")(10,Tt,101,12),l(11,"button",8),E("click",function(){return o.crearPlanificacion()}),l(12,"span"),c(13,"Crear Planificaci\xF3n"),r()(),s(14,"br"),r()()()()),t&2&&(b("ngClass",D(2,Et,o.active)),d(9),p(o.servicePlanificacion.loading()?9:10))},dependencies:[Q,J,H,ut,xt,z,j,G,O,q,U],encapsulation:2})};var Vt=()=>["/dashboard/charts"],kt=n=>({rotado:n}),tt=(n,a)=>({oculto:n,activo:a}),$t=n=>({low:n});function Wt(n,a){n&1&&s(0,"app-loadings")}function It(n,a){if(n&1&&(l(0,"option",14),c(1),r()),n&2){let t=a.$implicit,o=a.$index;b("value",o),d(),F(t.mes)}}function Rt(n,a){if(n&1){let t=P();l(0,"div",4)(1,"div",5)(2,"label",11),c(3,"Mes"),r(),l(4,"div",12)(5,"select",13),v("ngModelChange",function(i){u(t);let e=_(2);return g(e.indexPlanificacion,i)||(e.indexPlanificacion=i),x(i)}),$(6,It,2,2,"option",14,k),r()()(),l(8,"div",5)(9,"label",11),c(10,"Inicio"),r(),s(11,"input",15),r(),l(12,"div",5)(13,"label",11),c(14,"Cierre"),r(),s(15,"input",15),r()()}if(n&2){let t=_(2);d(5),f("ngModel",t.indexPlanificacion),d(),W(t.planificacionService.planificacion()),d(5),b("value",t.planificacionService.planificacion()[t.indexPlanificacion].inicio),d(4),b("value",t.planificacionService.planificacion()[t.indexPlanificacion].cierre)}}function At(n,a){if(n&1&&m(0,Rt,16,3,"div",4),n&2){let t=_();p(t.indexPlanificacion?0:-1)}}function Dt(n,a){n&1&&s(0,"app-loadings")}function Bt(n,a){n&1&&s(0,"app-loadings")(1,"br")}function Lt(n,a){n&1&&c(0," No hay reportes registrados ")}function Nt(n,a){n&1&&(c(0," \xA0"),s(1,"i",25))}function qt(n,a){n&1&&(c(0," \xA0"),s(1,"i",26))}function Ot(n,a){if(n&1&&m(0,Nt,2,0)(1,qt,2,0),n&2){let t,o=_(4).$implicit,i=_(3).$implicit,e=_(2);p(e.puntos((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos)>=e.planificacionService.planificacion()[e.indexPlanificacion].metas.tradicional.mystic.impulso?0:1)}}function Ut(n,a){n&1&&(c(0," \xA0"),s(1,"i",25))}function jt(n,a){n&1&&(c(0," \xA0"),s(1,"i",26))}function Gt(n,a){if(n&1&&m(0,Ut,2,0)(1,jt,2,0),n&2){let t,o=_(4).$implicit,i=_(3).$implicit,e=_(2);p(e.puntos((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos)>=e.planificacionService.planificacion()[e.indexPlanificacion].metas.tradicional.qerametik.impulso?0:1)}}function zt(n,a){if(n&1&&m(0,Ot,2,1)(1,Gt,2,1),n&2){let t,o=_(3).$implicit,i=_(3).$implicit,e=_(2);p(((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.marca)==="Mystic"?0:1)}}function Jt(n,a){n&1&&(c(0," \xA0"),s(1,"i",25))}function Ht(n,a){n&1&&(c(0," \xA0"),s(1,"i",26))}function Qt(n,a){if(n&1&&m(0,Jt,2,0)(1,Ht,2,0),n&2){let t,o=_(4).$implicit,i=_(3).$implicit,e=_(2);p(e.puntos((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos)>=e.planificacionService.planificacion()[e.indexPlanificacion].metas.tradicional.mystic.evento?0:1)}}function Yt(n,a){n&1&&(c(0," \xA0"),s(1,"i",25))}function Kt(n,a){n&1&&(c(0," \xA0"),s(1,"i",26))}function Xt(n,a){if(n&1&&m(0,Yt,2,0)(1,Kt,2,0),n&2){let t,o=_(4).$implicit,i=_(3).$implicit,e=_(2);p(e.puntos((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos)>=e.planificacionService.planificacion()[e.indexPlanificacion].metas.tradicional.qerametik.evento?0:1)}}function Zt(n,a){if(n&1&&m(0,Qt,2,1)(1,Xt,2,1),n&2){let t,o=_(3).$implicit,i=_(3).$implicit,e=_(2);p(((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.marca)==="Mystic"?0:1)}}function ti(n,a){if(n&1&&m(0,zt,2,1)(1,Zt,2,1),n&2){let t,o=_(2).$implicit,i=_(3).$implicit,e=_(2);p(((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.tipo)==="Impulso"?0:1)}}function ii(n,a){n&1&&(c(0," \xA0"),s(1,"i",25))}function ei(n,a){n&1&&(c(0," \xA0"),s(1,"i",26))}function ni(n,a){if(n&1&&m(0,ii,2,0)(1,ei,2,0),n&2){let t,o=_(4).$implicit,i=_(3).$implicit,e=_(2);p(e.puntos((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos)>=e.planificacionService.planificacion()[e.indexPlanificacion].metas.rebranding.mystic.impulso?0:1)}}function oi(n,a){n&1&&(c(0," \xA0"),s(1,"i",25))}function ai(n,a){n&1&&(c(0," \xA0"),s(1,"i",26))}function li(n,a){if(n&1&&m(0,oi,2,0)(1,ai,2,0),n&2){let t,o=_(4).$implicit,i=_(3).$implicit,e=_(2);p(e.puntos((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos)>=e.planificacionService.planificacion()[e.indexPlanificacion].metas.rebranding.qerametik.impulso?0:1)}}function ri(n,a){if(n&1&&m(0,ni,2,1)(1,li,2,1),n&2){let t,o=_(3).$implicit,i=_(3).$implicit,e=_(2);p(((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.marca)==="Mystic"?0:1)}}function ci(n,a){n&1&&(c(0," \xA0"),s(1,"i",25))}function _i(n,a){n&1&&(c(0," \xA0"),s(1,"i",26))}function di(n,a){if(n&1&&m(0,ci,2,0)(1,_i,2,0),n&2){let t,o=_(4).$implicit,i=_(3).$implicit,e=_(2);p(e.puntos((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos)>=e.planificacionService.planificacion()[e.indexPlanificacion].metas.rebranding.mystic.evento?0:1)}}function si(n,a){n&1&&(c(0," \xA0"),s(1,"i",25))}function mi(n,a){n&1&&(c(0," \xA0"),s(1,"i",26))}function pi(n,a){if(n&1&&m(0,si,2,0)(1,mi,2,0),n&2){let t,o=_(4).$implicit,i=_(3).$implicit,e=_(2);p(e.puntos((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos)>=e.planificacionService.planificacion()[e.indexPlanificacion].metas.rebranding.qerametik.evento?0:1)}}function Ci(n,a){if(n&1&&m(0,di,2,1)(1,pi,2,1),n&2){let t,o=_(3).$implicit,i=_(3).$implicit,e=_(2);p(((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.marca)==="Mystic"?0:1)}}function ui(n,a){if(n&1&&m(0,ri,2,1)(1,Ci,2,1),n&2){let t,o=_(2).$implicit,i=_(3).$implicit,e=_(2);p(((t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.tipo)==="Impulso"?0:1)}}function xi(n,a){if(n&1&&(c(0),T(1,"currency"),m(2,ti,2,1)(3,ui,2,1)),n&2){let t,o=_().$implicit,i=_(3).$implicit,e=_(2);rt(" ",V(1,3,(t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalSubtotal,"USD")," (",(t=e.getReportesPorFecha(i.nombre,i.apellido,o))==null?null:t.totalPuntos," Puntos) "),d(2),p(i.fija?2:3)}}function fi(n,a){if(n&1&&(l(0,"tr")(1,"td"),c(2),r(),l(3,"td"),c(4),r(),l(5,"td"),c(6),r(),l(7,"td"),c(8),r(),l(9,"td"),c(10),r(),l(11,"td"),c(12),T(13,"currency"),r()()),n&2){let t=a.$implicit;d(2),F(t.linea),d(2),F(t.marca),d(2),F(t.producto),d(2),F(t.cantidad),d(2),F(t.puntosTotales),d(2),F(V(13,6,t.subtotal,"USD"))}}function gi(n,a){if(n&1&&(l(0,"div",22)(1,"b"),c(2,"Establecimiento:"),r(),c(3),s(4,"br"),l(5,"b"),c(6,"Tipo:"),r(),c(7),s(8,"br"),l(9,"b"),c(10,"Observaci\xF3n:"),r(),c(11),s(12,"hr"),l(13,"table",27)(14,"thead")(15,"tr")(16,"th"),c(17,"Linea"),r(),l(18,"th"),c(19,"Marca"),r(),l(20,"th"),c(21,"Producto"),r(),l(22,"th"),c(23,"Cantidad (Und)"),r(),l(24,"th"),c(25,"Puntos"),r(),l(26,"th"),c(27,"Subtotal (USD)"),r()()(),l(28,"tbody"),$(29,fi,14,9,"tr",null,k),r()()()),n&2){let t,o,i,e,C=_(),h=C.$implicit,R=C.$index,et=_(3),y=et.$implicit,w=et.$index,S=_(2);b("ngClass",N(5,tt,!S.toggleVentas[w]||!S.toggleVentas[w][R],S.toggleVentas[w]&&S.toggleVentas[w][R])),d(3),I(" ",(t=S.getReportesPorFecha(y.nombre,y.apellido,h))==null?null:t.cliente," "),d(4),I(" ",(o=S.getReportesPorFecha(y.nombre,y.apellido,h))==null?null:o.tipo," "),d(4),I(" ",(i=S.getReportesPorFecha(y.nombre,y.apellido,h))==null?null:i.observacion," "),d(2),b("ngClass",N(8,tt,!S.toggleVentas[w]||!S.toggleVentas[w][R],S.toggleVentas[w]&&S.toggleVentas[w][R])),d(16),W((e=S.getReportesPorFecha(y.nombre,y.apellido,h))==null?null:e.productos)}}function vi(n,a){if(n&1){let t=P();l(0,"div")(1,"div",16)(2,"header",17)(3,"p",18),c(4),m(5,Lt,1,0)(6,xi,4,6),r(),l(7,"button",19),E("click",function(){let i=u(t).$index,e=_(3).$index,C=_(2);return x(C.toggleVentaSection(e,i))}),l(8,"span",8),s(9,"i",21),r()()(),m(10,gi,31,11,"div",22),r()(),s(11,"br")}if(n&2){let t=a.$implicit,o=_(3).$implicit,i=_(2);d(4),I(" ",t," - "),d(),p(i.getReportesPorFecha(o.nombre,o.apellido,t)?6:5),d(5),p(i.getReportesPorFecha(o.nombre,o.apellido,t)?10:-1)}}function hi(n,a){if(n&1&&$(0,vi,12,3,null,null,k),n&2){let t=_(4);W(t.getFechasDelRango())}}function bi(n,a){n&1&&s(0,"app-loadings")}function Si(n,a){if(n&1){let t=P();l(0,"div",16)(1,"header",17)(2,"p",18),c(3),T(4,"currency"),r(),l(5,"button",19),E("click",function(){u(t);let i=_().$index,e=_(2);return x(e.togglePromotoraSection(i))}),l(6,"span",20),s(7,"i",21),r()()(),l(8,"div",22)(9,"table",23)(10,"tr")(11,"th"),c(12,"Vendido"),r(),l(13,"th"),c(14,"Sueldo"),r(),l(15,"th"),c(16,"Incentivo"),r(),l(17,"th"),c(18,"% Gasto"),r()(),l(19,"tr")(20,"td"),c(21),T(22,"currency"),r(),l(23,"td"),c(24),T(25,"currency"),r(),l(26,"td"),c(27),T(28,"currency"),r(),l(29,"td",24),c(30),T(31,"number"),r()()(),m(32,hi,2,0)(33,bi,1,0,"app-loadings"),r()()}if(n&2){let t=_(),o=t.$implicit,i=t.$index,e=_(2);d(3),ct(" ",o.nombre," ",o.apellido," (",e.getPuntos(o.nombre,o.apellido)||0," puntos - ",V(4,12,e.obtenerIncentivo(e.puntos(e.getPuntos(o.nombre,o.apellido)),e.planificacionService.planificacion()[e.indexPlanificacion].incentivos),"USD")," Incentivo) "),d(3),b("ngClass",D(27,kt,e.isRotated[i])),d(2),b("ngClass",N(29,tt,!e.togglePromotora[i],e.togglePromotora[i])),d(13),F(V(22,15,e.getGastado(o.nombre,o.apellido)||0,"USD")),d(3),F(V(25,18,o.sueldo,"USD")),d(3),I("",V(28,21,e.obtenerIncentivo(e.puntos(e.getPuntos(o.nombre,o.apellido)),e.planificacionService.planificacion()[e.indexPlanificacion].incentivos),"USD")," "),d(2),b("ngClass",D(32,$t,((e.puntos(o.sueldo)+e.obtenerIncentivo(e.puntos(e.getPuntos(o.nombre,o.apellido)),e.planificacionService.planificacion()[e.indexPlanificacion].incentivos))*100/e.getGastado(o.nombre,o.apellido)||0)>=40)),d(),I(" ",V(31,24,(e.puntos(o.sueldo)+e.obtenerIncentivo(e.puntos(e.getPuntos(o.nombre,o.apellido)),e.planificacionService.planificacion()[e.indexPlanificacion].incentivos))*100/e.getGastado(o.nombre,o.apellido)||0,"1.0-1"),"% "),d(2),p(e.indexPlanificacion?32:33)}}function Ei(n,a){if(n&1&&m(0,Bt,2,0)(1,Si,34,34,"div",16),n&2){let t=_(2);p(t.planificacionService.planificacion()[t.indexPlanificacion]?1:0)}}function Fi(n,a){if(n&1&&$(0,Ei,2,1,null,null,k),n&2){let t=_();W(t.promotoras.users())}}var it=class n{ReportesServices=M(gt);promotoras=M(ft);planificacionService=M(A);active=!1;indexPlanificacion=null;reportesAgrupados=[];togglePromotora=[];toggleVentas={};isRotated=[];isRotated_={};constructor(){this.ReportesServices.getReportesAgrupados().subscribe({next:a=>{this.reportesAgrupados=a,console.log(this.reportesAgrupados)},error:a=>{console.error("Error al cargar los reportes:",a)}}),setTimeout(()=>{this.planificacionService.loading()||(this.indexPlanificacion=this.planificacionService.planificacion().length-1)},1e3)}togglePromotoraSection(a){this.togglePromotora[a]=!this.togglePromotora[a],this.isRotated[a]=!this.isRotated[a]}toggleVentaSection(a,t){this.toggleVentas[a]||(this.toggleVentas[a]=[]),this.toggleVentas[a][t]=!this.toggleVentas[a][t]}getPuntos(a,t){let o=this.reportesAgrupados.find(i=>i.promotora===`${a} ${t}`);return o?o.puntosAcumulados:0}getGastado(a,t){let o=this.reportesAgrupados.find(i=>i.promotora===`${a} ${t}`);return o?o.totalGastado:0}getReportes(a,t){let o=`${a} ${t}`,i=this.reportesAgrupados.find(e=>e.promotora===o);return i?i.reportes:[]}getFechasDelRango(){let a=new Date,t=new Date(a);t.setDate(a.getDate()+1);let o=t,i=new Date(this.planificacionService.planificacion()[this.indexPlanificacion].inicio);new Date(this.planificacionService.planificacion()[this.indexPlanificacion].cierre)<=a&&(o=new Date(this.planificacionService.planificacion()[this.indexPlanificacion].cierre));let e=[];for(;i<=o;)e.push(this.formatFecha(i)),i.setDate(i.getDate()+1);return e}formatFecha(a){let t=("0"+a.getDate()).slice(-2),o=("0"+(a.getMonth()+1)).slice(-2),i=a.getFullYear();return`${t}/${o}/${i}`}getReportesPorFecha(a,t,o){let i=`${a} ${t}`,e=this.convertirFechaAISO(o),C=this.reportesAgrupados.find(h=>h.promotora===i);if(C){let h=C.reportes.find(R=>R.fecha===e);return h||void 0}else return}convertirFechaAISO(a){let[t,o,i]=a.split("/");return`${i}-${o.padStart(2,"0")}-${t.padStart(2,"0")}`}calcularDiasHabiles(a,t){let o=new Date(a),i=new Date(t),e=0;if(o>i){let h=o;o=i,i=h}let C=new Date(o);for(;C<=i;){let h=C.getDay();h!==0&&h!==6&&e++,C.setDate(C.getDate()+1)}return e}puntos(a){return a||0}obtenerIncentivo(a,t){if(a<t[0].de)return 0;for(let o=0;o<t.length;o++){let i=t[o];if(a>=i.de&&a<=i.hasta)return i.incentivo}return 0}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=B({type:n,selectors:[["app-estadisticas"]],decls:24,vars:5,consts:[[3,"onCloseModal","active"],[1,"card",2,"background-color","#34495E","color","rgb(212, 212, 212)"],[1,"card-content"],["title","Estad\xEDsticas"],[1,"field","is-grouped"],[1,"control"],[1,"button","is-primary",3,"click"],[1,"button","is-success",3,"routerLink"],[1,"icon"],[1,"fas","fa-chart-pie"],[1,"header"],["for","",1,"label"],[1,"select"],[3,"ngModelChange","ngModel"],[3,"value"],["type","date","disabled","",1,"input",3,"value"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["aria-label","more options",1,"card-header-icon",3,"click"],[1,"icon",3,"ngClass"],["aria-hidden","true",1,"fas","fa-angle-down"],[1,"card-content",3,"ngClass"],[1,"table","is-fullwidth"],[3,"ngClass"],[1,"far","fa-thumbs-up",2,"color","rgb(129, 228, 129)"],[1,"far","fa-thumbs-down",2,"color","rgb(228, 129, 129)"],[1,"table","is-fullwidth","is-striped",3,"ngClass"]],template:function(t,o){t&1&&(l(0,"app-planificacion",0),E("onCloseModal",function(){return o.active=!1}),r(),l(1,"div",1)(2,"div",2),s(3,"app-title",3),r()(),s(4,"hr"),l(5,"div",4)(6,"div",5)(7,"button",6),E("click",function(){return o.active=!0}),l(8,"span"),c(9,"Nueva planificaci\xF3n"),r()()(),l(10,"div",5)(11,"button",7)(12,"span",8),s(13,"i",9),r(),l(14,"span"),c(15,"Ver gr\xE1ficas"),r()()()(),s(16,"br")(17,"br"),l(18,"span",10),m(19,Wt,1,0,"app-loadings")(20,At,1,1),s(21,"br"),r(),m(22,Dt,1,0,"app-loadings")(23,Fi,2,0)),t&2&&(b("active",o.active),d(11),b("routerLink",L(4,Vt)),d(8),p(o.planificacionService.loading()?19:20),d(3),p(o.planificacionService.loading()?22:23))},dependencies:[Ct,O,q,_t,dt,Q,J,H,z,j,G,Y,U,pt,mt],styles:['@charset "UTF-8";.oculto[_ngcontent-%COMP%]{overflow:hidden;max-height:0px;padding:0;margin:0;transition:max-height .5s ease-out,padding .3s ease-out,margin .3s ease-out}.activo[_ngcontent-%COMP%]{transition:max-height .9s ease-out,padding .3s ease-out,margin .3s ease-out}.icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .3s ease}.icon.rotado[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:rotate(180deg)}.low[_ngcontent-%COMP%]{color:#e48181;font-weight:bolder}.hight[_ngcontent-%COMP%]{color:#81e481;font-weight:bolder}']})};export{it as default};
