import{a as he,b as V,c as ze}from"./chunk-2D4G5YAQ.js";import{a as U}from"./chunk-OUWV2W3B.js";import{a as ge}from"./chunk-IWEUP4I2.js";import{a as ve,b as fe}from"./chunk-WDXG3P4G.js";import{g as Qe,i as De}from"./chunk-2LV7HNH4.js";import{a as Fe}from"./chunk-FW3GW2EH.js";import{c as de,d as me,g as pe,h as ue,i as be,j as _e}from"./chunk-NNPNTJPV.js";import"./chunk-TZTC4YCF.js";import{a as je}from"./chunk-O4672A62.js";import{a as xe}from"./chunk-UGQNDCKZ.js";import{$a as L,Ia as Y,Na as E,Tb as Te,Wa as Q,X as w,Xb as le,Ya as k,Yb as Ie,Za as j,Zb as ee,_a as F,ab as n,bb as i,cb as v,da as q,db as oe,e as Ue,ea as O,eb as R,fb as d,ib as a,jb as u,kb as h,lb as te,nb as re,ob as se,pb as ce,sb as X,ub as p,vb as Se,wb as b,za as c}from"./chunk-BH4UYFV3.js";function Ze(o,r){o&1&&v(0,"app-loadings")}function He(o,r){if(o&1&&(n(0,"option",21),a(1),i()),o&2){let e=r.$implicit,t=r.$index;Q("value",t),c(),u(e.mes)}}function Je(o,r){if(o&1){let e=oe();n(0,"div",13)(1,"div",14)(2,"label",15),a(3,"Mes"),i(),n(4,"div",16)(5,"select",17),R("change",function(){q(e);let l=d(2);return O(l.FijasPorDestajo())}),n(6,"option",18),a(7,"Fijas"),i(),n(8,"option",19),a(9,"Por destajo"),i()()()(),n(10,"div",14)(11,"label",15),a(12,"Mes"),i(),n(13,"div",16)(14,"select",20),ce("ngModelChange",function(l){q(e);let m=d(2);return se(m.indexPlanificacion,l)||(m.indexPlanificacion=l),O(l)}),R("change",function(){q(e);let l=d(2);return O(l.cambiarPlanificacion())}),F(15,He,2,2,"option",21,j),i()()(),n(17,"div",14)(18,"label",15),a(19,"Inicio"),i(),v(20,"input",22),i(),n(21,"div",14)(22,"label",15),a(23,"Cierre"),i(),v(24,"input",22),i()()}if(o&2){let e=d(2);c(14),re("ngModel",e.indexPlanificacion),c(),L(e.planificacionService.planificacion()),c(5),Q("value",e.simplificar(e.planificacionService.planificacion()[e.indexPlanificacion].inicio)),c(4),Q("value",e.simplificar(e.planificacionService.planificacion()[e.indexPlanificacion].cierre))}}function Ke(o,r){if(o&1&&E(0,Je,25,3,"div",13),o&2){let e=d();k(e.indexPlanificacion?0:-1)}}function Ye(o,r){if(o&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),p(7,"number"),i()()),o&2){let e=r.$implicit;c(2),u(e.nombre),c(2),u(e.linea),c(2),u(Se(7,3,e.cantidad))}}function et(o,r){if(o&1&&F(0,Ye,8,5,"tr",null,j),o&2){let e=d();L(e.topProductos.Mystic)}}function tt(o,r){if(o&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),p(7,"number"),i()()),o&2){let e=r.$implicit;c(2),u(e.nombre),c(2),u(e.linea),c(2),u(Se(7,3,e.cantidad))}}function it(o,r){if(o&1&&F(0,tt,8,5,"tr",null,j),o&2){let e=d();L(e.topProductos.Qerametik)}}var ie=class o{marcas_chart;lineas_chart;vendedoras_chart;vendedoras_qerametik;top3_chart;top3_chart_Qerametik;Reportes;ServiceReportes=w(fe);promotoras=w(ge);planificacionService=w(ve);indexPlanificacion=0;vendedoras;vendedoras_qeral;marcas;lineas;top3;top3_Qera;Cargado=!1;fijas=!0;Top3PromotorasMystic;Top3PromotorasQerametik;topProductos;topMystic=100;topQerametik=100;ProductoMasVendidoPorMarca={Mystic:"",Qerametik:""};constructor(){setTimeout(()=>{this.planificacionService.loading()||(this.indexPlanificacion=this.planificacionService.planificacion().length-1,this.recargarInfo())},500)}cambiarPlanificacion(){this.marcas_chart.destroy(),this.vendedoras_chart.destroy(),this.vendedoras_qerametik.destroy(),this.lineas_chart.destroy(),this.top3_chart&&this.top3_chart.destroy(),this.top3_chart_Qerametik&&this.top3_chart_Qerametik.destroy(),this.recargarInfo()}simplificar(r){return r.split("T")[0]}FijasPorDestajo(){this.fijas=!this.fijas,this.cambiarPlanificacion()}recargarInfo(){setTimeout(()=>{if(!this.planificacionService.loading()){this.Cargado=!0;let r=document.getElementById("vendedoras"),e=document.getElementById("vendedoras_Qerametik"),t=document.getElementById("marcas"),l=document.getElementById("lineas"),m=document.getElementById("top3"),P=document.getElementById("top3_Qerametik");this.ServiceReportes.getReportesAgrupados(this.fijas,this.planificacionService.planificacion()[this.indexPlanificacion].inicio,this.planificacionService.planificacion()[this.indexPlanificacion].cierre).subscribe(_=>{this.Reportes=_;let s=[],x=[],S=[],T=[];this.promotoras.users().filter(g=>g.fija===this.fijas&&g.marca==="Qerametik").forEach(g=>{s.push(`${g.nombre} ${g.apellido}`),x.push(this.getProductos_Mystic(g.nombre,g.apellido))});let D=s.map((g,C)=>({label:g,value:x[C]})).sort((g,C)=>C.value-g.value);s=D.map(g=>g.label),x=D.map(g=>g.value),this.promotoras.users().filter(g=>g.fija===this.fijas&&g.marca==="Mystic").forEach(g=>{S.push(`${g.nombre} ${g.apellido}`),T.push(this.getProductos_Qerametik(g.nombre,g.apellido))});let ne=S.map((g,C)=>({label:g,value:T[C]})).sort((g,C)=>C.value-g.value);S=ne.map(g=>g.label),T=ne.map(g=>g.value);let ae={id:"customDataLabelsQerametik",afterDatasetsDraw(g){let{ctx:C,data:z}=g;g.data.datasets.forEach((W,Z)=>{g.getDatasetMeta(Z).data.forEach(($,G)=>{let B=W.data[G];C.save(),C.font="12px Arial",C.fillStyle="#000",C.textAlign="center",C.fillText(B,$.x,$.y-10),C.restore()})})}},Ee={id:"customDoughnutLabels",afterDatasetsDraw(g){let{ctx:C,data:z}=g,W=z.datasets[0];g.getDatasetMeta(0).data.forEach((Z,H)=>{let $=W.data[H],G=z.labels[H],{x:B,y:N}=Z.tooltipPosition();C.save(),C.fillStyle="rgba(255, 255, 255, 0.8)";let I=6,J=C.measureText($).width,K=14;C.fillRect(B-J/2-I/2,N-K/2-I/2,J+I,K+I),C.strokeStyle="rgba(0, 0, 0, 0.3)",C.lineWidth=1,C.strokeRect(B-J/2-I/2,N-K/2-I/2,J+I,K+I),C.fillStyle="#000",C.font="12px Arial",C.textAlign="center",C.textBaseline="middle",C.fillText($,B,N),C.restore()})}};this.vendedoras_qeral={labels:s,datasets:[{label:"Ventas por vendedora",data:x,backgroundColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)","rgba(231, 76, 60, 1)","rgba(46, 204, 113, 1)","rgba(52, 152, 219, 1)","rgba(241, 196, 15, 1)","rgba(155, 89, 182, 1)","rgba(41, 128, 185, 1)","rgba(52, 152, 219, 1)","rgba(22, 160, 133, 1)","rgba(230, 126, 34, 1)","rgba(211, 84, 0, 1)","rgba(149, 165, 166, 1)","rgba(236, 240, 241, 1)","rgba(46, 204, 113, 1)","rgba(41, 128, 185, 1)","rgba(238, 112, 82, 1)","rgba(43, 206, 72, 1)","rgba(255, 127, 80, 1)","rgba(70, 130, 180, 1)","rgba(238, 130, 238, 1)","rgba(255, 105, 180, 1)","rgba(153, 50, 204, 1)","rgba(34, 193, 195, 1)","rgba(253, 187, 45, 1)","rgba(255, 218, 185, 1)","rgba(127, 255, 212, 1)","rgba(186, 85, 211, 1)","rgba(255, 140, 105, 1)","rgba(255, 165, 0, 1)","rgba(255, 99, 71, 1)","rgba(255, 0, 255, 1)","rgba(0, 255, 255, 1)","rgba(173, 216, 230, 1)","rgba(0, 128, 0, 1)","rgba(255, 192, 203, 1)","rgba(0, 255, 127, 1)","rgba(0, 0, 255, 1)","rgba(100, 149, 237, 1)","rgba(255, 99, 132, 1)","rgba(0, 255, 0, 1)","rgba(255, 140, 0, 1)","rgba(255, 105, 180, 1)","rgba(255, 69, 0, 1)","rgba(255, 228, 181, 1)","rgba(220, 20, 60, 1)","rgba(255, 0, 0, 1)","rgba(0, 191, 255, 1)","rgba(255, 140, 255, 1)","rgba(255, 20, 147, 1)","rgba(127, 255, 0, 1)","rgba(255, 99, 132, 1)","rgba(75, 0, 130, 1)","rgba(50, 205, 50, 1)","rgba(248, 248, 255, 1)","rgba(255, 228, 196, 1)","rgba(240, 128, 128, 1)","rgba(0, 250, 154, 1)","rgba(255, 99, 71, 1)","rgba(176, 224, 230, 1)","rgba(245, 222, 179, 1)","rgba(255, 182, 193, 1)","rgba(135, 206, 235, 1)","rgba(255, 160, 122, 1)","rgba(255, 105, 180, 1)","rgba(255, 127, 80, 1)"],borderColor:["rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(231, 76, 60)","rgb(46, 204, 113)","rgb(52, 152, 219)","rgb(241, 196, 15)","rgb(155, 89, 182)","rgb(41, 128, 185)","rgb(52, 152, 219)","rgb(22, 160, 133)","rgb(230, 126, 34)","rgb(211, 84, 0)","rgb(149, 165, 166)","rgb(236, 240, 241)","rgb(46, 204, 113)","rgb(41, 128, 185)","rgb(238, 112, 82)","rgb(43, 206, 72)","rgb(255, 127, 80)","rgb(70, 130, 180)","rgb(238, 130, 238)","rgb(255, 105, 180)","rgb(153, 50, 204)","rgb(34, 193, 195)","rgb(253, 187, 45)","rgb(255, 218, 185)","rgb(127, 255, 212)","rgb(186, 85, 211)","rgb(255, 140, 105)","rgb(255, 165, 0)","rgb(255, 99, 71)","rgb(255, 0, 255)","rgb(0, 255, 255)","rgb(173, 216, 230)","rgb(0, 128, 0)","rgb(255, 192, 203)","rgb(0, 255, 127)","rgb(0, 0, 255)","rgb(100, 149, 237)","rgb(255, 99, 132)","rgb(0, 255, 0)","rgb(255, 140, 0)","rgb(255, 105, 180)","rgb(255, 69, 0)","rgb(255, 228, 181)","rgb(220, 20, 60)","rgb(255, 0, 0)","rgb(0, 191, 255)","rgb(255, 140, 255)","rgb(255, 20, 147)","rgb(127, 255, 0)","rgb(255, 99, 132)","rgb(75, 0, 130)","rgb(50, 205, 50)","rgb(248, 248, 255)","rgb(255, 228, 196)","rgb(240, 128, 128)","rgb(0, 250, 154)","rgb(255, 99, 71)","rgb(176, 224, 230)","rgb(245, 222, 179)","rgb(255, 182, 193)","rgb(135, 206, 235)","rgb(255, 160, 122)","rgb(255, 105, 180)","rgb(255, 127, 80)"],hoverOffset:4}]},this.vendedoras={labels:S,datasets:[{label:"Ventas por vendedora",data:T,backgroundColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)","rgba(231, 76, 60, 1)","rgba(46, 204, 113, 1)","rgba(52, 152, 219, 1)","rgba(241, 196, 15, 1)","rgba(155, 89, 182, 1)","rgba(41, 128, 185, 1)","rgba(52, 152, 219, 1)","rgba(22, 160, 133, 1)","rgba(230, 126, 34, 1)","rgba(211, 84, 0, 1)","rgba(149, 165, 166, 1)","rgba(236, 240, 241, 1)","rgba(46, 204, 113, 1)","rgba(41, 128, 185, 1)","rgba(238, 112, 82, 1)","rgba(43, 206, 72, 1)","rgba(255, 127, 80, 1)","rgba(70, 130, 180, 1)","rgba(238, 130, 238, 1)","rgba(255, 105, 180, 1)","rgba(153, 50, 204, 1)","rgba(34, 193, 195, 1)","rgba(253, 187, 45, 1)","rgba(255, 218, 185, 1)","rgba(127, 255, 212, 1)","rgba(186, 85, 211, 1)","rgba(255, 140, 105, 1)","rgba(255, 165, 0, 1)","rgba(255, 99, 71, 1)","rgba(255, 0, 255, 1)","rgba(0, 255, 255, 1)","rgba(173, 216, 230, 1)","rgba(0, 128, 0, 1)","rgba(255, 192, 203, 1)","rgba(0, 255, 127, 1)","rgba(0, 0, 255, 1)","rgba(100, 149, 237, 1)","rgba(255, 99, 132, 1)","rgba(0, 255, 0, 1)","rgba(255, 140, 0, 1)","rgba(255, 105, 180, 1)","rgba(255, 69, 0, 1)","rgba(255, 228, 181, 1)","rgba(220, 20, 60, 1)","rgba(255, 0, 0, 1)","rgba(0, 191, 255, 1)","rgba(255, 140, 255, 1)","rgba(255, 20, 147, 1)","rgba(127, 255, 0, 1)","rgba(255, 99, 132, 1)","rgba(75, 0, 130, 1)","rgba(50, 205, 50, 1)","rgba(248, 248, 255, 1)","rgba(255, 228, 196, 1)","rgba(240, 128, 128, 1)","rgba(0, 250, 154, 1)","rgba(255, 99, 71, 1)","rgba(176, 224, 230, 1)","rgba(245, 222, 179, 1)","rgba(255, 182, 193, 1)","rgba(135, 206, 235, 1)","rgba(255, 160, 122, 1)","rgba(255, 105, 180, 1)","rgba(255, 127, 80, 1)"],borderColor:["rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(231, 76, 60)","rgb(46, 204, 113)","rgb(52, 152, 219)","rgb(241, 196, 15)","rgb(155, 89, 182)","rgb(41, 128, 185)","rgb(52, 152, 219)","rgb(22, 160, 133)","rgb(230, 126, 34)","rgb(211, 84, 0)","rgb(149, 165, 166)","rgb(236, 240, 241)","rgb(46, 204, 113)","rgb(41, 128, 185)","rgb(238, 112, 82)","rgb(43, 206, 72)","rgb(255, 127, 80)","rgb(70, 130, 180)","rgb(238, 130, 238)","rgb(255, 105, 180)","rgb(153, 50, 204)","rgb(34, 193, 195)","rgb(253, 187, 45)","rgb(255, 218, 185)","rgb(127, 255, 212)","rgb(186, 85, 211)","rgb(255, 140, 105)","rgb(255, 165, 0)","rgb(255, 99, 71)","rgb(255, 0, 255)","rgb(0, 255, 255)","rgb(173, 216, 230)","rgb(0, 128, 0)","rgb(255, 192, 203)","rgb(0, 255, 127)","rgb(0, 0, 255)","rgb(100, 149, 237)","rgb(255, 99, 132)","rgb(0, 255, 0)","rgb(255, 140, 0)","rgb(255, 105, 180)","rgb(255, 69, 0)","rgb(255, 228, 181)","rgb(220, 20, 60)","rgb(255, 0, 0)","rgb(0, 191, 255)","rgb(255, 140, 255)","rgb(255, 20, 147)","rgb(127, 255, 0)","rgb(255, 99, 132)","rgb(75, 0, 130)","rgb(50, 205, 50)","rgb(248, 248, 255)","rgb(255, 228, 196)","rgb(240, 128, 128)","rgb(0, 250, 154)","rgb(255, 99, 71)","rgb(176, 224, 230)","rgb(245, 222, 179)","rgb(255, 182, 193)","rgb(135, 206, 235)","rgb(255, 160, 122)","rgb(255, 105, 180)","rgb(255, 127, 80)"],hoverOffset:4}]},this.vendedoras_chart=new U(r,{type:"bar",data:this.vendedoras,options:{plugins:{legend:{display:!0}}},plugins:[ae]}),this.vendedoras_qerametik=new U(e,{type:"bar",data:this.vendedoras_qeral,options:{plugins:{legend:{display:!0}}},plugins:[ae]}),this.ServiceReportes.cargarReportes_(this.planificacionService.planificacion()[this.indexPlanificacion].inicio,this.planificacionService.planificacion()[this.indexPlanificacion].cierre).subscribe(g=>{let C=g;C=C.filter(y=>y.promotora.fija===this.fijas);let z=0,W=0,Z=0,H=0,$=0,G={},B={},N={},I={};C.forEach(y=>{let M=`${y.promotora.nombre} ${y.promotora.apellido}`;I[M]||(I[M]={Mystic:0,Qerametik:0}),y.promotora.marca==="Mystic"?y.productos.forEach(f=>{f.producto.marca==="Mystic"&&(I[M].Mystic+=f.cantidad)}):y.promotora.marca==="Qerametik"&&y.productos.forEach(f=>{f.producto.marca==="Qerametik"&&(I[M].Qerametik+=f.cantidad)});let Xe=Object.entries(I).map(([f,A])=>({promotoraId:f,cantidadMystic:A.Mystic})).sort((f,A)=>A.cantidadMystic-f.cantidadMystic).slice(0,3),Ge=Object.entries(I).map(([f,A])=>({promotoraId:f,cantidadQerametik:A.Qerametik})).sort((f,A)=>A.cantidadQerametik-f.cantidadQerametik).slice(0,3);this.Top3PromotorasMystic=Xe,this.Top3PromotorasQerametik=Ge,y.productos.forEach(f=>{f.producto.marca==="Mystic"?(z+=f.cantidad,B[f.producto._id]?B[f.producto._id].cantidad+=f.cantidad:B[f.producto._id]={nombre:f.producto.producto,cantidad:f.cantidad,linea:f.producto.linea},f.producto.linea==="Tradicional"?Z+=f.cantidad:f.producto.linea==="Rebranding"&&(H+=f.cantidad)):f.producto.marca==="Qerametik"&&(W+=f.cantidad,N[f.producto._id]?N[f.producto._id].cantidad+=f.cantidad:N[f.producto._id]={nombre:f.producto.producto,cantidad:f.cantidad,linea:f.producto.linea},$+=f.cantidad);let A=`${y.promotora.nombre} ${y.promotora.apellido}`;G[A]?G[A]+=f.cantidad:G[A]=f.cantidad})});let J=Object.entries(B).map(([y,M])=>({productoId:y,linea:M.linea,nombre:M.nombre,cantidad:M.cantidad})).sort((y,M)=>M.cantidad-y.cantidad).slice(0,this.topMystic),K=Object.entries(N).map(([y,M])=>({productoId:y,linea:M.linea,nombre:M.nombre,cantidad:M.cantidad})).sort((y,M)=>M.cantidad-y.cantidad).slice(0,this.topQerametik);this.topProductos={Mystic:J,Qerametik:K};let Ut=Object.entries(G).map(([y,M])=>({promotoraId:y,totalVentas:M})).sort((y,M)=>M.totalVentas-y.totalVentas).slice(0,3).map(y=>({nombre:y.promotoraId,totalVentas:y.totalVentas}));this.marcas={labels:["Mystic","Qerametik"],datasets:[{label:"Marca mas vendida",data:[z,W],backgroundColor:["#001a72","#6bcaba"],borderColor:["#fe5000","#c99700"],hoverOffset:4}]},this.marcas_chart=new U(t,{type:"doughnut",data:this.marcas,options:{plugins:{legend:{display:!0}}},plugins:[Ee]}),this.lineas={labels:["Tradicional","Tradicional Qerametik","Rebranding"],datasets:[{label:"Marca mas vendida",data:[Z,$,H],backgroundColor:["#001a72","#6bcaba","#fe5000"],borderColor:["#fe5000","#c99700","#001a72"],hoverOffset:4}]},this.lineas_chart=new U(l,{type:"doughnut",data:this.lineas,options:{plugins:{legend:{display:!0}}},plugins:[Ee]});let ke=this.Top3PromotorasMystic,Me=this.Top3PromotorasQerametik,$e=ke.map(y=>y.promotoraId),Ne=ke.map(y=>y.cantidadMystic),qe=Me.map(y=>y.promotoraId),Oe=Me.map(y=>y.cantidadQerametik);this.top3={labels:$e,datasets:[{axis:"y",label:"Ventas realizadas",data:Ne,fill:!1,backgroundColor:["rgba(255, 99, 132, 1)","rgba(255, 159, 64, 1)","rgba(255, 205, 86, 1)"],borderColor:["rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)"],borderWidth:1}]},this.top3_Qera={labels:qe,datasets:[{axis:"y",label:"Ventas realizadas",data:Oe,fill:!1,backgroundColor:["rgba(255, 99, 132, 1)","rgba(255, 159, 64, 1)","rgba(255, 205, 86, 1)"],borderColor:["rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)"],borderWidth:1}]},this.top3_chart=new U(m,{type:"bar",data:this.top3,options:{indexAxis:"y",plugins:{legend:{display:!0}}},plugins:[ae]}),this.top3_chart_Qerametik=new U(P,{type:"bar",data:this.top3_Qera,options:{indexAxis:"y",plugins:{legend:{display:!0}}},plugins:[ae]}),this.Cargado=!1})})}},1e3)}getPuntos(r,e){let t=this.Reportes.find(l=>l.promotora===`${r} ${e}`);return t?t.puntosAcumulados:0}getProductos_Mystic(r,e){let t=this.Reportes.find(l=>l.promotora===`${r} ${e}`);return t?t.productosQerametik:0}getProductos_Qerametik(r,e){let t=this.Reportes.find(l=>l.promotora===`${r} ${e}`);return t?t.productosMystic:0}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=Y({type:o,selectors:[["app-graficas"]],decls:81,vars:3,consts:[[1,"header"],[1,"columns"],[1,"column"],[1,"card"],[1,"card-content"],[1,"title"],["id","marcas"],["id","lineas"],["id","top3"],["id","top3_Qerametik"],[1,"table","is-fullwidth","is-striped"],["id","vendedoras"],["id","vendedoras_Qerametik"],[1,"field","is-grouped"],[1,"control"],["for","",1,"label"],[1,"select"],[3,"change"],["value","Fijas"],["values","NoFijas"],[3,"ngModelChange","change","ngModel"],[3,"value"],["type","date","disabled","",1,"input",3,"value"]],template:function(e,t){e&1&&(n(0,"span",0),E(1,Ze,1,0,"app-loadings")(2,Ke,1,1),v(3,"br"),i(),n(4,"div",1)(5,"div",2)(6,"div",3)(7,"div",4)(8,"span",5),a(9,"Marca mas vendida"),i(),v(10,"br")(11,"canvas",6),i()()(),n(12,"div",2)(13,"div",3)(14,"div",4)(15,"span",5),a(16,"Linea mas vendida"),i(),v(17,"br")(18,"canvas",7),i()()()(),n(19,"div",1)(20,"div",2)(21,"div",3)(22,"div",4)(23,"span",5),a(24,"TOP 3 Promotoras Mystic"),i(),v(25,"br")(26,"canvas",8),i()()(),n(27,"div",2)(28,"div",3)(29,"div",4)(30,"span",5),a(31,"TOP 3 Promotoras Qerametik"),i(),v(32,"br")(33,"canvas",9),i()()()(),n(34,"div",1)(35,"div",2)(36,"div",3)(37,"div",4)(38,"span",5),a(39,"TOP Productos Mystic"),i(),v(40,"br"),n(41,"table",10)(42,"thead")(43,"tr")(44,"th"),a(45,"Producto"),i(),n(46,"th"),a(47,"Linea"),i(),n(48,"th"),a(49,"Cantidad"),i()()(),n(50,"tbody"),E(51,et,2,0),i()()()()(),n(52,"div",2)(53,"div",3)(54,"div",4)(55,"span",5),a(56,"TOP Productos Qerametik"),i(),v(57,"br"),n(58,"table",10)(59,"thead")(60,"tr")(61,"th"),a(62,"Producto"),i(),n(63,"th"),a(64,"Linea"),i(),n(65,"th"),a(66,"Cantidad"),i()()(),n(67,"tbody"),E(68,it,2,0),i()()()()()(),n(69,"div",3)(70,"div",4)(71,"span",5),a(72,"Vendedoras Mystic"),i(),v(73,"br")(74,"canvas",11),i()(),n(75,"div",3)(76,"div",4)(77,"span",5),a(78,"Vendedoras Qerametik"),i(),v(79,"br")(80,"canvas",12),i()()),e&2&&(c(),k(t.planificacionService.loading()?1:2),c(50),k(t.topProductos?51:-1),c(17),k(t.topProductos?68:-1))},dependencies:[_e,ue,be,pe,de,me,ee,le,xe],encapsulation:2})};var ye=Ue(ze());var Be=o=>["/dashboard/cliente",o],we=o=>["/dashboard/region",o];function nt(o,r){if(o&1&&(n(0,"option",9),a(1),i()),o&2){let e=r.$implicit,t=r.$index;Q("value",t),c(),u(e.mes)}}function at(o,r){if(o&1&&(a(0),p(1,"currency")),o&2){let e=d().$implicit;h(" ",b(1,1,e.Incentivo,"USD")," ")}}function ot(o,r){o&1&&(a(0),p(1,"currency")),o&2&&h(" ",b(1,1,0,"USD")," ")}function rt(o,r){if(o&1&&(n(0,"span",26),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h(" ",b(2,1,t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"]),"1.2-2"),"%")}}function st(o,r){if(o&1&&(n(0,"span",27),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"]),"1.2-2"),"%")}}function ct(o,r){if(o&1&&(n(0,"span",28),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"]),"1.2-2"),"%")}}function lt(o,r){if(o&1&&(n(0,"span",26),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h(" ",b(2,1,t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"]),"1.2-2"),"%")}}function dt(o,r){if(o&1&&(n(0,"span",27),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"]),"1.2-2"),"%")}}function mt(o,r){if(o&1&&(n(0,"span",28),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"]),"1.2-2"),"%")}}function pt(o,r){if(o&1&&(n(0,"span",26),a(1),i()),o&2){let e=d().$implicit,t=d(2);c(),h(" ",t.calcularPromedio(t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"])),"%")}}function ut(o,r){if(o&1&&(n(0,"span",27),a(1),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",t.calcularPromedio(t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"])),"%")}}function bt(o,r){if(o&1&&(n(0,"span",28),a(1),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",t.calcularPromedio(t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"])),"%")}}function _t(o,r){if(o&1&&(n(0,"span",26),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPromedioRebranding(e["Productos vendidos"],e.Rebranding),"1.2-2"),"%")}}function xt(o,r){if(o&1&&(n(0,"span",28),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPromedioRebranding(e["Productos vendidos"],e.Rebranding),"1.2-2"),"%")}}function gt(o,r){if(o&1&&(n(0,"span",26),a(1),p(2,"number"),i()),o&2){let e=d().$implicit;c(),h("",b(2,1,e.Rebranding,"1.0-0")," unds.")}}function vt(o,r){if(o&1&&(n(0,"span",28),a(1),p(2,"number"),i()),o&2){let e=d().$implicit;c(),h("",b(2,1,e.Rebranding,"1.0-0")," unds.")}}function ft(o,r){if(o&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),p(11,"number"),i(),n(12,"td"),a(13),p(14,"number"),i(),n(15,"td"),a(16),p(17,"number"),i(),n(18,"td"),a(19),p(20,"number"),i(),n(21,"td"),E(22,at,2,4)(23,ot,2,4),i(),n(24,"td"),E(25,rt,3,4,"span",26)(26,st,3,4,"span",27)(27,ct,3,4,"span",28),i(),n(28,"td"),E(29,lt,3,4,"span",26)(30,dt,3,4,"span",27)(31,mt,3,4,"span",28),i(),n(32,"td"),E(33,pt,2,1,"span",26)(34,ut,2,1,"span",27)(35,bt,2,1,"span",28),i(),n(36,"td"),E(37,_t,3,4,"span",26)(38,xt,3,4,"span",28),i(),n(39,"td"),E(40,gt,3,4,"span",26)(41,vt,3,4,"span",28),i(),n(42,"td"),a(43),p(44,"currency"),i(),n(45,"td"),a(46),p(47,"currency"),i(),n(48,"td"),a(49),p(50,"number"),i(),n(51,"td"),a(52),p(53,"number"),i(),n(54,"td"),a(55),p(56,"currency"),i(),n(57,"td"),a(58),p(59,"number"),i()()),o&2){let e=r.$implicit,t=d(2);c(2),u(e.Promotora),c(2),u(e.Marca),c(2),u(e.Region),c(2),u(e.clientes_atendidos),c(2),te("",b(11,22,e["Total ventas de impulso"],"1.0-0")," (",e["Dias impulso"]," dias)"),c(3),te("",b(14,25,e["Total ventas de evento"],"1.0-0")," (",e["Dias evento"]," dias)"),c(3),u(b(17,28,e["Productos vendidos"],"1.0-0")),c(3),u(b(20,31,e.Puntuaci\u00F3n,"1.1-1")),c(3),k(e.Rebranding>=50?22:23),c(3),k(t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"])>=60?25:t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"])>=30?26:27),c(4),k(t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"])>=60?29:t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"])>=30?30:31),c(4),k(t.calcularPromedio(t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"]))>=60?33:t.calcularPromedio(t.calcularPorcentaje_evento_Mystic(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Mystic(e["Total ventas de impulso"],e["Dias impulso"]))>=30?34:35),c(4),k(t.calcularPromedioRebranding(e["Productos vendidos"],e.Rebranding)>=30?37:38),c(3),k(e.Rebranding>=50?40:41),c(3),u(b(44,34,e["Costo promedio"],"USD")),c(3),u(b(47,37,e["Monto de Und. Vendidas"],"USD")),c(3),h("",b(50,40,e.Incidencia,"1.2-2"),"%"),c(3),u(b(53,43,e["Sueldo diario"],"1.2-2")),c(3),u(b(56,46,e["Ventas diarias"],"USD")),c(3),h("",b(59,49,e["Sueldo diario"]*100/e["Ventas diarias"],"1.2-2"),"%")}}function ht(o,r){o&1&&(n(0,"tr")(1,"td",29),a(2,"No hay datos"),i()())}function yt(o,r){if(o&1&&(a(0),p(1,"currency")),o&2){let e=d().$implicit;h(" ",b(1,1,e.Incentivo,"USD")," ")}}function Ct(o,r){o&1&&(a(0),p(1,"currency")),o&2&&h(" ",b(1,1,0,"USD")," ")}function St(o,r){if(o&1&&(n(0,"span",26),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h(" ",b(2,1,t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"]),"1.2-2"),"%")}}function Pt(o,r){if(o&1&&(n(0,"span",27),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"]),"1.2-2"),"%")}}function Et(o,r){if(o&1&&(n(0,"span",28),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"]),"1.2-2"),"%")}}function kt(o,r){if(o&1&&(n(0,"span",26),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h(" ",b(2,1,t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"]),"1.2-2"),"%")}}function Mt(o,r){if(o&1&&(n(0,"span",27),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"]),"1.2-2"),"%")}}function Tt(o,r){if(o&1&&(n(0,"span",28),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"]),"1.2-2"),"%")}}function It(o,r){if(o&1&&(n(0,"span",26),a(1),i()),o&2){let e=d().$implicit,t=d(2);c(),h(" ",t.calcularPromedio(t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"])),"%")}}function Qt(o,r){if(o&1&&(n(0,"span",27),a(1),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",t.calcularPromedio(t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"])),"%")}}function Dt(o,r){if(o&1&&(n(0,"span",28),a(1),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",t.calcularPromedio(t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"])),"%")}}function jt(o,r){if(o&1&&(n(0,"span",26),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPromedioRebranding(e["Productos vendidos"],e.capilares),"1.2-2"),"%")}}function Ft(o,r){if(o&1&&(n(0,"span",28),a(1),p(2,"number"),i()),o&2){let e=d().$implicit,t=d(2);c(),h("",b(2,1,t.calcularPromedioRebranding(e["Productos vendidos"],e.capilares),"1.2-2"),"%")}}function Lt(o,r){if(o&1&&(n(0,"span",26),a(1),p(2,"number"),i()),o&2){let e=d().$implicit;c(),h("",b(2,1,e.capilares,"1.0-0")," unds.")}}function Rt(o,r){if(o&1&&(n(0,"span",28),a(1),p(2,"number"),i()),o&2){let e=d().$implicit;c(),h("",b(2,1,e.capilares,"1.0-0")," unds.")}}function At(o,r){if(o&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td"),a(10),p(11,"number"),i(),n(12,"td"),a(13),p(14,"number"),i(),n(15,"td"),a(16),p(17,"number"),i(),n(18,"td"),a(19),p(20,"number"),i(),n(21,"td"),E(22,yt,2,4)(23,Ct,2,4),i(),n(24,"td"),E(25,St,3,4,"span",26)(26,Pt,3,4,"span",27)(27,Et,3,4,"span",28),i(),n(28,"td"),E(29,kt,3,4,"span",26)(30,Mt,3,4,"span",27)(31,Tt,3,4,"span",28),i(),n(32,"td"),E(33,It,2,1,"span",26)(34,Qt,2,1,"span",27)(35,Dt,2,1,"span",28),i(),n(36,"td"),E(37,jt,3,4,"span",26)(38,Ft,3,4,"span",28),i(),n(39,"td"),E(40,Lt,3,4,"span",26)(41,Rt,3,4,"span",28),i(),n(42,"td"),a(43),p(44,"currency"),i(),n(45,"td"),a(46),p(47,"currency"),i(),n(48,"td"),a(49),i(),n(50,"td"),a(51),p(52,"number"),i(),n(53,"td"),a(54),p(55,"currency"),i(),n(56,"td"),a(57),p(58,"number"),i()()),o&2){let e=r.$implicit,t=d(2);c(2),u(e.Promotora),c(2),u(e.Marca),c(2),u(e.Region),c(2),u(e.clientes_atendidos),c(2),te("",b(11,22,e["Total ventas de impulso"],"1.0-0")," (",e["Dias impulso"]," dias)"),c(3),te("",b(14,25,e["Total ventas de evento"],"1.0-0")," (",e["Dias evento"]," dias)"),c(3),u(b(17,28,e["Productos vendidos"],"1.0-0")),c(3),u(b(20,31,e.Puntuaci\u00F3n,"1.1-1")),c(3),k(e.capilares>=30?22:23),c(3),k(t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"])>=60?25:t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"])>=30?26:27),c(4),k(t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"])>=60?29:t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"])>=30?30:31),c(4),k(t.calcularPromedio(t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"]))>=60?33:t.calcularPromedio(t.calcularPorcentaje_evento_Qerametik(e["Total ventas de evento"],e["Dias evento"]),t.calcularPorcentaje_impulso_Qerametik(e["Total ventas de impulso"],e["Dias impulso"]))>=30?34:35),c(4),k(t.calcularPromedioRebranding(e["Productos vendidos"],e.capilares)>=20?37:38),c(3),k(e.capilares>=30?40:41),c(3),u(b(44,34,e["Costo promedio"],"USD")),c(3),u(b(47,37,e["Monto de Und. Vendidas"],"USD")),c(3),h("",e.Incidencia,"%"),c(2),u(b(52,40,e["Sueldo diario"],"1.2-2")),c(3),u(b(55,43,e["Ventas diarias"],"USD")),c(3),h("",b(58,46,e["Sueldo diario"]*100/e["Ventas diarias"],"1.2-2"),"%")}}function Bt(o,r){o&1&&(n(0,"tr")(1,"td",29),a(2,"No hay datos"),i()())}function wt(o,r){if(o&1&&(n(0,"tr")(1,"td")(2,"a",30),a(3),i()(),n(4,"td"),a(5),i(),n(6,"td"),a(7),i(),n(8,"td"),a(9),i(),n(10,"td"),a(11),i(),n(12,"td"),a(13),i(),n(14,"td"),a(15),i(),n(16,"td"),a(17),i()()),o&2){let e=r.$implicit;c(2),Q("routerLink",X(9,Be,e.cliente)),c(),u(e.cliente),c(2),u(e.impulsos_mystic),c(2),u(e.eventos_mystic),c(2),u(e.impulsos_qerametik),c(2),u(e.eventos_qerametik),c(2),u(e.cantidad_mystic),c(2),u(e.cantidad_Qerametik),c(2),u(e.cantidad)}}function Vt(o,r){if(o&1&&(n(0,"tr")(1,"td")(2,"a",30),a(3),i()(),n(4,"td"),a(5),i()()),o&2){let e=r.$implicit;c(2),Q("routerLink",X(3,we,e.zona)),c(),u(e.zona),c(2),u(e.totalProductos)}}function $t(o,r){if(o&1&&(n(0,"tr")(1,"td")(2,"a",30),a(3),i()(),n(4,"td"),a(5),i()()),o&2){let e=r.$implicit;c(2),Q("routerLink",X(3,we,e.zona)),c(),u(e.zona),c(2),u(e.totalProductos)}}function Nt(o,r){if(o&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td")(4,"a",30),a(5),i()()()),o&2){let e=r.$implicit,t=r.$index;c(2),u(t+1),c(2),Q("routerLink",X(3,Be,e)),c(),u(e)}}function qt(o,r){if(o&1){let e=oe();n(0,"span",0),a(1,"Mystic"),i(),v(2,"br")(3,"br"),n(4,"table",11)(5,"thead",12)(6,"tr")(7,"th"),a(8,"Promotora"),i(),n(9,"th"),a(10,"Marca"),i(),n(11,"th"),a(12,"Regi\xF3n"),i(),n(13,"th"),a(14,"Clientes atendidos"),i(),n(15,"th"),a(16,"Ventas / impulso"),i(),n(17,"th"),a(18,"Ventas / evento"),i(),n(19,"th"),a(20,"Productos vendidos"),i(),n(21,"th"),a(22,"Puntuaci\xF3n"),i(),n(23,"th"),a(24,"Incentivo"),i(),n(25,"th"),a(26,"Promedio de exito Impuso"),i(),n(27,"th"),a(28,"Promedio de exito Eventos"),i(),n(29,"th"),a(30,"Promedio General"),i(),n(31,"th"),a(32,"Rebrandig %"),i(),n(33,"th"),a(34,"Rebrandig und"),i(),n(35,"th"),a(36,"Costo Promedio"),i(),n(37,"th"),a(38,"Monto Und. Vendidas"),i(),n(39,"th"),a(40,"Incidencias"),i(),n(41,"th"),a(42,"Sueldo diario"),i(),n(43,"th"),a(44,"Ventas diarias"),i(),n(45,"th"),a(46,"Incidencia diaria"),i()()(),n(47,"tbody"),F(48,ft,60,52,"tr",null,j),n(50,"tr")(51,"td",13)(52,"strong"),a(53,"Total:"),i()(),n(54,"td"),a(55),p(56,"currency"),i(),v(57,"td")(58,"td")(59,"td")(60,"td")(61,"td"),n(62,"td"),a(63),p(64,"currency"),i(),v(65,"td"),i(),E(66,ht,3,0,"tr"),i()(),v(67,"hr"),n(68,"span",0),a(69,"Qerametik"),i(),v(70,"br")(71,"br"),n(72,"table",11)(73,"thead",12)(74,"tr")(75,"th"),a(76,"Promotora"),i(),n(77,"th"),a(78,"Marca"),i(),n(79,"th"),a(80,"Regi\xF3n"),i(),n(81,"th"),a(82,"Clientes atendidos"),i(),n(83,"th"),a(84,"Ventas / impulso"),i(),n(85,"th"),a(86,"Ventas / evento"),i(),n(87,"th"),a(88,"Productos vendidos"),i(),n(89,"th"),a(90,"Puntuaci\xF3n"),i(),n(91,"th"),a(92,"Incentivo"),i(),n(93,"th"),a(94,"Promedio de exito Impuso"),i(),n(95,"th"),a(96,"Promedio de exito Eventos"),i(),n(97,"th"),a(98,"Promedio General"),i(),n(99,"th"),a(100,"Capilares %"),i(),n(101,"th"),a(102,"Capilares unds"),i(),n(103,"th"),a(104,"Costo Promedio"),i(),n(105,"th"),a(106,"Monto Und. Vendidas"),i(),n(107,"th"),a(108,"Incidencias"),i(),n(109,"th"),a(110,"Sueldo diario"),i(),n(111,"th"),a(112,"Ventas diarias"),i(),n(113,"th"),a(114,"Incidencia diaria"),i()()(),n(115,"tbody"),F(116,At,59,49,"tr",null,j),n(118,"tr")(119,"td",13)(120,"strong"),a(121,"Total:"),i()(),n(122,"td"),a(123),p(124,"currency"),i(),v(125,"td")(126,"td")(127,"td")(128,"td"),n(129,"td"),a(130),p(131,"currency"),i(),v(132,"td"),i(),E(133,Bt,3,0,"tr"),i()(),n(134,"button",14),R("click",function(){q(e);let l=d();return O(l.exportarExcel())}),a(135,` Exportar a Excel
`),i(),v(136,"br")(137,"br"),n(138,"div",15)(139,"div",16)(140,"table",17)(141,"thead",12)(142,"tr")(143,"td",18)(144,"span",19),a(145,"Productos vendidos por clientes"),i(),a(146," \xA0 "),n(147,"div",20),R("click",function(){q(e);let l=d();return O(l.exportarClientes())}),n(148,"span",21),v(149,"i",22),i(),n(150,"span"),a(151,"Descargar"),i()(),v(152,"hr"),i()(),n(153,"tr")(154,"th"),a(155,"Cliente"),i(),n(156,"th"),a(157,"Impulsos Mystic"),i(),n(158,"th"),a(159,"Eventos Mystic"),i(),n(160,"th"),a(161,"Impulsos Qerametik"),i(),n(162,"th"),a(163,"Eventos Qerametik"),i(),n(164,"th"),a(165,"Mystic"),i(),n(166,"th"),a(167,"Qerametik"),i(),n(168,"th"),a(169,"Total"),i()()(),n(170,"tbody"),F(171,wt,18,11,"tr",null,j),i()()()(),n(173,"div",15)(174,"div",23)(175,"span",0),a(176,"Mystic"),i(),v(177,"hr"),n(178,"table",17)(179,"thead")(180,"tr")(181,"th"),a(182,"Zona"),i(),n(183,"th"),a(184,"Total Productos Vendidos"),i()()(),n(185,"tbody"),F(186,Vt,6,5,"tr",null,j),i()()(),n(188,"div",23)(189,"span",0),a(190,"Qerametik"),i(),v(191,"hr"),n(192,"table",17)(193,"thead")(194,"tr")(195,"th"),a(196,"Zona"),i(),n(197,"th"),a(198,"Total Productos Vendidos"),i()()(),n(199,"tbody"),F(200,$t,6,5,"tr",null,j),i()()()(),n(202,"div",24)(203,"div",25)(204,"span",0),a(205,"Clientes no atendidos"),i(),a(206,"\xA0 "),n(207,"div",20),R("click",function(){q(e);let l=d();return O(l.exportarClientesNoAtendidos())}),n(208,"span",21),v(209,"i",22),i(),n(210,"span"),a(211,"Descargar"),i()(),v(212,"br"),n(213,"table",17)(214,"thead")(215,"tr"),v(216,"th"),n(217,"th"),a(218,"Cliente"),i()()(),n(219,"tbody"),F(220,Nt,6,5,"tr",null,j),i()()()()}if(o&2){let e=d();c(48),L(e.datos_Mystic),c(7),u(b(56,6,e.calcularTotales(e.datos_Mystic,"Incentivo"),"USD")),c(8),u(b(64,9,e.calcularTotales(e.datos_Mystic,"Monto de Und. Vendidas"),"USD")),c(3),k(e.datos_Mystic.length<1?66:-1),c(50),L(e.datos_Qerametik),c(7),u(b(124,12,e.calcularTotales(e.datos_Qerametik,"Incentivo"),"USD")),c(7),u(b(131,15,e.calcularTotales(e.datos_Qerametik,"Monto de Und. Vendidas"),"USD")),c(3),k(e.datos_Qerametik.length<1?133:-1),c(38),L(e.clientesArray),c(15),L(e.ventasPorZonaMystic),c(14),L(e.ventasPorZonaQerametik),c(20),L(e.clientesNoAtendidos)}}function Ot(o,r){o&1&&v(0,"app-loadings")}var Ce=class o{exportarExcel(){let r=this.reportesAgrupadosOrdenados.filter(s=>{let x=this.obtenerIncentivos(s.puntosMystic,s.puntosQerametik,s.promotora,s.marca,s.productosMystic).mystic;return s.marca==="Mystic"||s.marca!=="Mystic"&&s.productosMystic>0}).map(s=>{let x=this.calcularPromedioRebranding(s.productosMystic,s.porcentajeRebranding),S=s.porcentajeRebranding,T=this.obtenerIncentivos(s.puntosMystic,s.puntosQerametik,s.promotora,s.marca,s.productosMystic).mystic;return S<50&&(T=0),{Promotora:s.promotora,Marca:s.marca,Region:s.region,"Clientes antendidos":s.clientes_atendidos,"Productos vendidos":s.productosMystic.toFixed(2),"Costo promedio":this.promedio.mystic.toFixed(2),Puntuaci\u00F3n:s.puntosMystic.toFixed(2),Incentivo:T.toFixed(2),"Promedio de exito Impuso":this.calcularPorcentaje_impulso_Mystic(s.totalImpulsos,this.buscarDiasTrabajados(s.promotora).impulsoMystic).toFixed(2),"Promedio de exito Eventos":this.calcularPorcentaje_evento_Mystic(s.totalEventos,this.buscarDiasTrabajados(s.promotora).eventoMystic).toFixed(2),"Promedio General":this.calcularPromedio(this.calcularPorcentaje_impulso_Mystic(s.totalImpulsos,this.buscarDiasTrabajados(s.promotora).impulsoMystic),this.calcularPorcentaje_evento_Mystic(s.totalEventos,this.buscarDiasTrabajados(s.promotora).eventoMystic)).toFixed(2),"Rebranding %":`${x.toFixed(2)}%`,"Rebranding unds.":`${S.toFixed(2)} unds.`,"Monto de Und. Vendidas":(this.promedio.mystic*s.productosMystic).toFixed(2),Incidencia:(T/(this.promedio.mystic*s.productosMystic)*100).toFixed(2),"Total ventas de impulso":s.totalImpulsos.toFixed(2),"Total ventas de evento":s.totalEventos.toFixed(2),"Dias impulso":this.buscarDiasTrabajados(s.promotora).impulsoMystic.toFixed(2),"Dias evento":this.buscarDiasTrabajados(s.promotora).eventoMystic.toFixed(2),"Sueldo diario":(Number(s.sueldo)/this.buscarDiasTrabajados(s.promotora).totalDias).toFixed(2),"Ventas diarias":(this.promedio.mystic*s.productosMystic/this.buscarDiasTrabajados(s.promotora).totalDias).toFixed(2),"incidencia diaria":Number((Number(s.sueldo)/this.buscarDiasTrabajados(s.promotora).totalDias).toFixed(2))*100/Number((this.promedio.mystic*s.productosMystic/this.buscarDiasTrabajados(s.promotora).totalDias).toFixed(2))}}).sort((s,x)=>Number(x.Puntuaci\u00F3n)-Number(s.Puntuaci\u00F3n)),e=this.reportesAgrupadosOrdenados.filter(s=>{let x=this.obtenerIncentivos(s.puntosMystic,s.puntosQerametik,s.promotora,s.marca,s.productosMystic).qerametik;return s.marca==="Qerametik"||s.marca!=="Qerametik"&&s.productosQerametik>0}).map(s=>{let x=this.calcularPromedioRebranding(s.productosQerametik,s.porcentajeCapilares),S=s.porcentajeCapilares,T=this.obtenerIncentivos(s.puntosMystic,s.puntosQerametik,s.promotora,s.marca,s.productosMystic).qerametik;return S<20&&(T=0),{Promotora:s.promotora,Marca:s.marca,Region:s.region,"Clientes antendidos":s.clientes_atendidos,"Productos vendidos":s.productosQerametik,"Costo promedio":this.promedio.qerametik,Puntuaci\u00F3n:s.puntosQerametik,Incentivo:T.toFixed(2),"Promedio de exito Impuso":this.calcularPorcentaje_impulso_Qerametik(s.totalImpulsos_qerametik,this.buscarDiasTrabajados(s.promotora).impulsoQerametik),"Promedio de exito Eventos":this.calcularPorcentaje_evento_Qerametik(s.totalEventos_qerametik,this.buscarDiasTrabajados(s.promotora).eventoQerametik),"Promedio General":this.calcularPromedio(this.calcularPorcentaje_impulso_Qerametik(s.totalImpulsos_qerametik,this.buscarDiasTrabajados(s.promotora).impulsoQerametik),this.calcularPorcentaje_evento_Qerametik(s.totalEventos_qerametik,this.buscarDiasTrabajados(s.promotora).eventoQerametik)),"Capilares %":`${x.toFixed(2)}%`,"Capilares unds.":`${S.toFixed(2)} unds.`,"Monto de Und. Vendidas":this.promedio.qerametik*s.productosQerametik,Incidencia:(T/(this.promedio.qerametik*s.productosQerametik)*100).toFixed(2),"Total ventas de impulso":s.totalImpulsos_qerametik,"Total ventas de evento":s.totalEventos_qerametik,"Dias impulso":this.buscarDiasTrabajados(s.promotora).impulsoQerametik,"Dias evento":this.buscarDiasTrabajados(s.promotora).eventoQerametik,"Sueldo diario":Number(s.sueldo)/this.buscarDiasTrabajados(s.promotora).totalDias,"Ventas diarias":this.promedio.qerametik*s.productosQerametik/this.buscarDiasTrabajados(s.promotora).totalDias,"incidencia diaria":Number((Number(s.sueldo)/this.buscarDiasTrabajados(s.promotora).totalDias).toFixed(2))*100/Number((this.promedio.qerametik*s.productosQerametik/this.buscarDiasTrabajados(s.promotora).totalDias).toFixed(2))}}).sort((s,x)=>x.Puntuaci\u00F3n-s.Puntuaci\u00F3n),t=V.json_to_sheet(r),l=V.json_to_sheet(e),P=he({Sheets:{"Reportes Mystic":t,"Reportes Qerametik":l},SheetNames:["Reportes Mystic","Reportes Qerametik"]},{bookType:"xlsx",type:"array"}),_=new Blob([P],{type:"application/octet-stream"});(0,ye.saveAs)(_,"ReportePromotoras.xlsx")}calcularIncidencia(r){return(this.obtenerIncentivo(r.puntosAcumulados,this.planificacionService.planificacion()[this.indexPlanificacion].incentivos)/r.totalGastado*100).toFixed(2)+"%"}calcularSueldoPorDia(r){return this.puntos(this.BuscarInfo(r.promotora)?.sueldo)/r.reportes.length}calcularVentasPorDia(r){return r.totalGastado/r.reportes.length}calcularIncidenciaPorcentaje(r){return(this.calcularSueldoPorDia(r)/this.calcularVentasPorDia(r)*100).toFixed(2)+"%"}calcularPromedioRebranding(r,e){return e/r*100}ReportesServices=w(fe);reportesAgrupados;planificacionService=w(ve);promotoras=w(ge);clientes=w(Fe);datos_Mystic=[];datos_Qerametik=[];clientesMystic=[];clientesQerametik=[];ventasPorZonaMystic=[];ventasPorZonaQerametik=[];clientesNoAtendidos=[];fijas=!0;clientesArray=[];promedio={mystic:0,qerametik:0};loading=!0;clientesConProductos=[];indexPlanificacion=0;ordenActual={columna:"totalGastado",ascendente:!1};reportesAgrupadosOrdenados=[];ventasPorZona=[];constructor(){this.indexPlanificacion=this.planificacionService.planificacion().length-1,this.refresh()}cambiar(){this.refresh()}refresh(){this.loading=!0,setTimeout(()=>{this.promedio.mystic=this.planificacionService.planificacion()[this.indexPlanificacion].precios.Mystic,this.promedio.qerametik=this.planificacionService.planificacion()[this.indexPlanificacion].precios.Qerametik,this.planificacionService.loading()||(this.ReportesServices.getReportesAgrupados_(this.fijas,this.planificacionService.planificacion()[this.indexPlanificacion].inicio,this.planificacionService.planificacion()[this.indexPlanificacion].cierre).subscribe({next:r=>{this.reportesAgrupados=r,this.reportesAgrupadosOrdenados=[...this.reportesAgrupados],this.datos_Mystic=this.reportesAgrupadosOrdenados.filter(t=>{let l=this.obtenerIncentivos(t.puntosMystic,t.puntosQerametik,t.promotora,t.marca,t.productosMystic).mystic;return t.marca==="Mystic"||t.marca!=="Mystic"&&t.productosMystic>0}).map(t=>({Promotora:t.promotora,Marca:t.marca,Region:t.region,clientes_atendidos:t.clientes_atendidos,Rebranding:t.porcentajeRebranding,"Productos vendidos":t.productosMystic,"Costo promedio":this.promedio.mystic,Puntuaci\u00F3n:t.puntosMystic,Incentivo:this.obtenerIncentivos(t.puntosMystic,t.puntosQerametik,t.promotora,t.marca,t.productosMystic).mystic,"Monto de Und. Vendidas":this.promedio.mystic*t.productosMystic,Incidencia:(this.obtenerIncentivos(t.puntosMystic,t.puntosQerametik,t.promotora,t.marca,t.productosMystic).mystic/(this.promedio.mystic*t.productosMystic)*100).toFixed(2),"Total ventas de impulso":t.totalImpulsos,"Total ventas de evento":t.totalEventos,"Dias trabajados":this.buscarDiasTrabajados(t.promotora).totalDias,"Metas alcanzadas":t.conteoMetaUnidades,"Dias impulso":this.buscarDiasTrabajados(t.promotora).impulsoMystic,"Dias evento":this.buscarDiasTrabajados(t.promotora).eventoMystic,"Sueldo diario":Number(t.sueldo)/this.buscarDiasTrabajados(t.promotora).totalDias,"Ventas diarias":this.promedio.mystic*t.productosMystic/this.buscarDiasTrabajados(t.promotora).totalDias})).sort((t,l)=>l.Puntuaci\u00F3n-t.Puntuaci\u00F3n),this.datos_Qerametik=this.reportesAgrupadosOrdenados.filter(t=>{let l=this.obtenerIncentivos(t.puntosMystic,t.puntosQerametik,t.promotora,t.marca,t.productosMystic).qerametik;return t.marca==="Qerametik"||t.marca!=="Qerametik"&&t.productosQerametik>0}).map(t=>({Promotora:t.promotora,Marca:t.marca,Region:t.region,clientes_atendidos:t.clientes_atendidos,capilares:t.porcentajeCapilares,"Productos vendidos":t.productosQerametik,"Costo promedio":this.promedio.qerametik,Puntuaci\u00F3n:t.puntosQerametik,Incentivo:this.obtenerIncentivos(t.puntosMystic,t.puntosQerametik,t.promotora,t.marca,t.productosQerametik).qerametik,"Monto de Und. Vendidas":this.promedio.qerametik*t.productosQerametik,Incidencia:(this.obtenerIncentivos(t.puntosMystic,t.puntosQerametik,t.promotora,t.marca,t.productosQerametik).qerametik/(this.promedio.qerametik*t.productosQerametik)*100).toFixed(2),"Total ventas de impulso":t.totalImpulsos_qerametik,"Total ventas de evento":t.totalEventos_qerametik,"Dias trabajados":this.buscarDiasTrabajados(t.promotora).totalDias,"Metas alcanzadas":t.conteoMetaUnidadesQ,"Dias impulso":this.buscarDiasTrabajados(t.promotora).impulsoQerametik,"Dias evento":this.buscarDiasTrabajados(t.promotora).eventoQerametik,"Sueldo diario":Number(t.sueldo)/this.buscarDiasTrabajados(t.promotora).totalDias,"Ventas diarias":this.promedio.qerametik*t.productosQerametik/this.buscarDiasTrabajados(t.promotora).totalDias})).sort((t,l)=>l.Puntuaci\u00F3n-t.Puntuaci\u00F3n);let e=new Set;this.clientes.clientes().forEach(t=>{this.reportesAgrupadosOrdenados.some(m=>m.reportes.some(P=>P.cliente===t.cliente))||e.add(t.cliente)}),this.clientesNoAtendidos=Array.from(e),this.loading=!1},error:r=>{console.error("Error al cargar los reportes:",r)}}),this.calcularProductosPorCliente(),this.calcularVentasPorZona())},500)}buscarDiasTrabajados(r){let e=this.reportesAgrupados.find(t=>t.promotora===r);if(e){let t=new Set(e.reportes.filter(s=>s.tipo==="Impulso"&&s.productos.some(x=>x.marca==="Mystic")).map(s=>s.fecha)),l=new Set(e.reportes.filter(s=>s.tipo==="Evento"&&s.productos.some(x=>x.marca==="Mystic")).map(s=>s.fecha)),m=new Set(e.reportes.filter(s=>s.tipo==="Impulso"&&s.productos.some(x=>x.marca==="Qerametik")).map(s=>s.fecha)),P=new Set(e.reportes.filter(s=>s.tipo==="Evento"&&s.productos.some(x=>x.marca==="Qerametik")).map(s=>s.fecha));return{totalDias:new Set(e.reportes.map(s=>s.fecha)).size,impulsoMystic:t.size,eventoMystic:l.size,impulsoQerametik:m.size,eventoQerametik:P.size}}return{totalDias:0,impulsoMystic:0,eventoMystic:0,impulsoQerametik:0,eventoQerametik:0}}simplificar(r){return r.split("T")[0]}puntos(r){return r||0}calcularTotales(r,e){return r.reduce((t,l)=>t+(l[e]||0),0)}obtenerIncentivo(r,e){if(r<e[0].de)return 0;for(let t=0;t<e.length;t++){let l=e[t];if(r>=l.de&&r<=l.hasta)return l.incentivo}return 0}obtenerIncentivos(r,e,t,l,m){let P=0,_=0,s=0;if(this.fijas){if(r<this.planificacionService.planificacion()[this.indexPlanificacion].incentivos[0].de)_=0;else for(let x=0;x<this.planificacionService.planificacion()[this.indexPlanificacion].incentivos.length;x++){let S=this.planificacionService.planificacion()[this.indexPlanificacion].incentivos[x];r>=S.de&&r<=S.hasta&&(_=S.incentivo)}if(e<this.planificacionService.planificacion()[this.indexPlanificacion].incentivos_qerametik[0].de)s=0;else for(let x=0;x<this.planificacionService.planificacion()[this.indexPlanificacion].incentivos_qerametik.length;x++){let S=this.planificacionService.planificacion()[this.indexPlanificacion].incentivos_qerametik[x];e>=S.de&&e<=S.hasta&&(s=S.incentivo)}return{totales:_+s,mystic:_,qerametik:s}}else{let x=this.buscarDiasTrabajados(t).totalDias,S=this.planificacionService.planificacion()[this.indexPlanificacion].metas.rebranding.mystic.impulso,T=this.planificacionService.planificacion()[this.indexPlanificacion].metas.rebranding.qerametik.impulso;if(console.log(l),l==="Mystic"){let D=S*x;m>=D?_=25:_=0}else{let D=T*x;m>=D?s=25:s=0}return{totales:_+s,mystic:_,qerametik:s}}}BuscarInfo(r){let e=r.split(" "),t=e[0],l=e[1];return this.promotoras.users().find(m=>m.nombre===t&&m.apellido===l)}ordenarPor(r){this.ordenActual.columna===r?this.ordenActual.ascendente=!this.ordenActual.ascendente:(this.ordenActual.columna=r,this.ordenActual.ascendente=!0),this.reportesAgrupadosOrdenados=[...this.reportesAgrupados].sort((e,t)=>{let l=e[r],m=t[r];return l<m?this.ordenActual.ascendente?-1:1:l>m?this.ordenActual.ascendente?1:-1:0})}calcularProductosPorCliente(){let r={},e=[],t=[];this.ReportesServices.cargarReportes_(this.planificacionService.planificacion()[this.indexPlanificacion].inicio,this.planificacionService.planificacion()[this.indexPlanificacion].cierre).subscribe({next:l=>{this.clientesArray=[];let m={};l=l.filter(_=>_.promotora.fija===this.fijas),l.forEach(_=>{if(!_.cliente||!_.cliente._id||_.cliente.cliente==="FALTA JUSTIFICADA"){console.warn('Reporte excluido (cliente inv\xE1lido o "FALTA JUSTIFICADA"):',_);return}let s=_.cliente._id,x=_.cliente.cliente,S=_.productos[0]?.producto?.marca;r[s]||(r[s]={cliente:x,totalProductos:0,marca:S}),m[x]||(m[x]={cliente:x,cantidad:0,cantidad_mystic:0,cantidad_Qerametik:0,impulsos_mystic:0,eventos_mystic:0,impulsos_qerametik:0,eventos_qerametik:0}),_.tipo==="Impulso"&&S==="Mystic"?m[x].impulsos_mystic+=1:_.tipo==="Evento"&&S==="Mystic"?m[x].eventos_mystic+=1:_.tipo==="Impulso"&&S==="Qerametik"?m[x].impulsos_qerametik+=1:_.tipo==="Evento"&&S==="Qerametik"&&(m[x].eventos_qerametik+=1);let T=_.productos.reduce((D,ne)=>D+ne.cantidad,0);r[s].totalProductos+=T,_.productos.forEach(D=>{m[x].cantidad+=D.cantidad,D.producto.marca==="Mystic"?m[x].cantidad_mystic+=D.cantidad:D.producto.marca==="Qerametik"&&(m[x].cantidad_Qerametik+=D.cantidad)})}),this.clientesArray=Object.values(m).sort((_,s)=>s.cantidad-_.cantidad),Object.values(r).forEach(_=>{_.marca==="Mystic"?e.push({cliente:_.cliente,totalProductos:_.totalProductos}):_.marca==="Qerametik"&&t.push({cliente:_.cliente,totalProductos:_.totalProductos})}),this.clientesMystic=e.sort((_,s)=>s.totalProductos-_.totalProductos),this.clientesQerametik=t.sort((_,s)=>s.totalProductos-_.totalProductos)},error:l=>{console.error("Error al cargar los reportes:",l)}})}calcularVentasPorZona(){let r={},e={};this.ReportesServices.cargarReportes_(this.planificacionService.planificacion()[this.indexPlanificacion].inicio,this.planificacionService.planificacion()[this.indexPlanificacion].cierre).subscribe({next:t=>{t=t.filter(l=>l.promotora.fija===this.fijas),t.forEach(l=>{if(!l.promotora||!l.promotora.region){console.warn("Reporte excluido (promotora sin zona):",l);return}let m=l.promotora.region;l.productos.forEach(P=>{let _=P.cantidad;P.producto.marca==="Mystic"?(r[m]||(r[m]={zona:m,totalProductos:0}),r[m].totalProductos+=_):P.producto.marca==="Qerametik"&&(e[m]||(e[m]={zona:m,totalProductos:0}),e[m].totalProductos+=_)})}),this.ventasPorZonaMystic=Object.values(r).sort((l,m)=>m.totalProductos-l.totalProductos),this.ventasPorZonaQerametik=Object.values(e).sort((l,m)=>m.totalProductos-l.totalProductos)},error:t=>{console.error("Error al cargar los reportes:",t)}})}getTotal(r){return this.reportesAgrupadosOrdenados.reduce((e,t)=>e+(Number(t[r])||0),0)}CambiarAfijas(r){r.value==="Fijas"?(this.fijas=!0,this.refresh(),this.ReportesServices.getReportesAgrupados_(!0,this.planificacionService.planificacion()[this.indexPlanificacion].inicio,this.planificacionService.planificacion()[this.indexPlanificacion].cierre).subscribe({next:e=>{this.reportesAgrupados=e,this.reportesAgrupadosOrdenados=[...this.reportesAgrupados]},error:e=>{console.error("Error al cargar los reportes:",e)}})):(this.fijas=!1,this.refresh(),this.ReportesServices.getReportesAgrupados_(!1,this.planificacionService.planificacion()[this.indexPlanificacion].inicio,this.planificacionService.planificacion()[this.indexPlanificacion].cierre).subscribe({next:e=>{this.reportesAgrupados=e,this.reportesAgrupadosOrdenados=[...this.reportesAgrupados]},error:e=>{console.error("Error al cargar los reportes:",e)}}))}calcularPorcentaje(r,e){return r/e*100}calcularPorcentaje_impulso_Mystic(r,e){let t=r/30;return e<1?0:t*100/e}calcularPorcentaje_evento_Mystic(r,e){let t=r/40;return e<1?0:t*100/e}calcularPorcentaje_impulso_Qerametik(r,e){let t=r/15;return e<1?0:t*100/e}calcularPorcentaje_evento_Qerametik(r,e){let t=r/30;return e<1?0:t*100/e}calcularPromedio(r,e){return console.log(),Number(r===0||e===0?(r+e).toFixed(2):((r+e)/2).toFixed(2))}exportarClientesNoAtendidos(){if(!this.clientesNoAtendidos||this.clientesNoAtendidos.length===0){console.warn("No hay clientes para exportar.");return}let r=this.clientesNoAtendidos.map(P=>({Clientes:P})),e=V.json_to_sheet(r),t=V.book_new();V.book_append_sheet(t,e,"Clientes No Atendidos");let l=he(t,{bookType:"xlsx",type:"array"}),m=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,ye.saveAs)(m,"ClientesNoAtendidos.xlsx")}exportarClientes(){if(!this.clientesArray||this.clientesArray.length===0){console.warn("No hay clientes para exportar.");return}let r=this.clientesArray.map(P=>({Cliente:P.cliente,"Impulsos Mystic":P.impulsos_mystic,"Eventos Mystic":P.eventos_mystic,"Impulsos Qerametik":P.impulsos_qerametik,"Eventos Qerametik":P.eventos_qerametik,"Cantidad Mystic":P.cantidad_mystic,"Cantidad Qerametik":P.cantidad_Qerametik,"Cantidad Total":P.cantidad})),e=V.json_to_sheet(r),t=V.book_new();V.book_append_sheet(t,e,"Clientes");let l=he(t,{bookType:"xlsx",type:"array"}),m=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,ye.saveAs)(m,"Clientes.xlsx")}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=Y({type:o,selectors:[["app-listas"]],decls:31,vars:4,consts:[[1,"title"],[1,"field","is-grouped"],[1,"control"],["for","",1,"label"],[1,"select"],[3,"change"],["value","Fijas"],["value","NoFijas"],[3,"ngModelChange","change","ngModel"],[3,"value"],["type","date","disabled","",1,"input",3,"value"],[1,"table","is-fullwidth","is-striped",2,"font-size","x-small"],[2,"position","sticky","top","0","z-index","1"],["colspan","7"],[1,"button","is-primary",3,"click"],[1,"columns"],[1,"column",2,"max-height","100vh","overflow","scroll"],[1,"table","is-fullwidth","is-striped"],["colspan","8"],[1,"title",2,"width","100%","display","block"],[1,"button","is-succes",3,"click"],[1,"icon"],[1,"fas","fa-download"],[1,"column"],[1,"card-",2,"max-height","600px","overflow-y","scroll"],[1,"card-content"],[1,"tag","is-success"],[1,"tag","is-warning"],[1,"tag","is-danger"],["colspan","10"],[3,"routerLink"]],template:function(e,t){e&1&&(n(0,"span",0),a(1,"Promotoras"),i(),v(2,"hr"),n(3,"div",1)(4,"div",2)(5,"label",3),a(6,"\xA0"),i(),n(7,"div",4)(8,"select",5),R("change",function(m){return t.CambiarAfijas(m.target)}),n(9,"option",6),a(10,"Fijas"),i(),n(11,"option",7),a(12,"Por destajos"),i()()()(),n(13,"div",2)(14,"label",3),a(15,"Mes"),i(),n(16,"div",4)(17,"select",8),ce("ngModelChange",function(m){return se(t.indexPlanificacion,m)||(t.indexPlanificacion=m),m}),R("change",function(){return t.cambiar()}),F(18,nt,2,2,"option",9,j),i()()(),n(20,"div",2)(21,"label",3),a(22,"Inicio"),i(),v(23,"input",10),i(),n(24,"div",2)(25,"label",3),a(26,"Cierre"),i(),v(27,"input",10),i()(),v(28,"hr"),E(29,qt,222,18)(30,Ot,1,0,"app-loadings")),e&2&&(c(17),re("ngModel",t.indexPlanificacion),c(),L(t.planificacionService.planificacion()),c(5),Q("value",t.simplificar(t.planificacionService.planificacion()[t.indexPlanificacion].inicio)),c(4),Q("value",t.simplificar(t.planificacionService.planificacion()[t.indexPlanificacion].cierre)),c(2),k(t.loading?30:29))},dependencies:[ee,le,Ie,_e,ue,be,pe,de,me,De,Qe,xe],styles:["@media (prefers-color-scheme: dark){thead[_ngcontent-%COMP%]{background:#14161a;color:#fff}}"]})};var Ve=o=>({"is-active":o});function Xt(o,r){o&1&&v(0,"app-graficas")}function Gt(o,r){o&1&&v(0,"app-listas")}var Pe=class o{graficas=!0;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=Y({type:o,selectors:[["app-reportes-generales"]],decls:17,vars:7,consts:[[1,"card",2,"background","linear-gradient(180deg, rgba(0,26,114,1) 0%, rgba(53,164,182,1) 49%, rgba(107,202,186,1) 100%)","color","rgb(212, 212, 212)"],[1,"card-content"],["title","Estad\xEDsticas"],[1,"subtitle",2,"color","white"],[1,"tabs"],[3,"click","ngClass"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1),v(2,"app-title",2),n(3,"span",3),a(4,"Gr\xE1ficas"),i()()(),v(5,"hr"),n(6,"div",4)(7,"ul")(8,"li",5),R("click",function(){return t.graficas=!t.graficas}),n(9,"a"),a(10,"Gr\xE1ficas"),i()(),n(11,"li",5),R("click",function(){return t.graficas=!t.graficas}),n(12,"a"),a(13,"Listas"),i()()()(),v(14,"br"),E(15,Xt,1,0,"app-graficas")(16,Gt,1,0,"app-listas")),e&2&&(c(8),Q("ngClass",X(3,Ve,t.graficas)),c(3),Q("ngClass",X(5,Ve,!t.graficas)),c(4),k(t.graficas?15:16))},dependencies:[je,ie,ee,Te,Ce],encapsulation:2})};export{Pe as default};
