import{a as J}from"./chunk-LHB4DLZO.js";import{a as te}from"./chunk-ET5GL3KV.js";import{a as Z}from"./chunk-P7RRBNRB.js";import{a as Y}from"./chunk-EC3ZKULI.js";import{a as $}from"./chunk-TA66JFPR.js";import{b as A,c as L,d as O,e as X,g as q,h as j,i as U,j as z}from"./chunk-UYLEAET2.js";import"./chunk-HUNMWK37.js";import{$a as S,Ia as V,Na as w,Ub as N,Wa as T,Wb as B,X as P,Ya as v,Za as b,Zb as I,_a as y,ab as n,bb as o,cb as C,da as m,db as x,e as ee,ea as p,eb as h,fb as s,hb as H,ib as l,ja as E,kb as W,lb as M,ob as _,pb as u,qb as f,sb as K,tb as k,vb as D,xb as F,za as d}from"./chunk-5XISTBJQ.js";var le=c=>({"is-active":c});function re(c,r){if(c&1){let e=x();n(0,"option",22),h("click",function(){let t=m(e).$implicit,a=s();return p(a.plan.cliente_nombre=t.cliente)}),l(1),o()}if(c&2){let e=r.$implicit;H("value","",e._id,"__",e.cliente,"(",e.marca,")"),d(),M(" ",e.cliente," (",e.marca,")")}}function ce(c,r){if(c&1){let e=x();n(0,"button",23),h("click",function(){m(e);let t=s();return p(t.onAgregarPlanificacion.emit())}),n(1,"span"),l(2,"Listo"),o()()}}var R=class c{newPlanificacion;plan;onCloseModal=new E;onAgregarPlanificacion=new E;Clientes=P(J);qlo="";cerrar(){this.onCloseModal.emit()}addCliente(r){let e=r.value.split("__"),i=e[0],t=e[1];this.plan.cliente=i,this.plan.cliente_nombre=t}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=V({type:c,selectors:[["app-new-planificacion"]],inputs:{newPlanificacion:"newPlanificacion",plan:"plan"},outputs:{onCloseModal:"onCloseModal",onAgregarPlanificacion:"onAgregarPlanificacion"},decls:35,vars:13,consts:[[1,"modal",3,"ngClass"],[1,"modal-background"],[1,"modal-card"],[1,"modal-card-head"],[1,"modal-card-title"],["aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"field"],[1,"control"],[1,"label"],[1,"select"],[3,"ngModelChange","ngModel"],["value","Evento"],["value","Impulso"],["for","",1,"label"],[3,"ngModelChange","change","ngModel"],[3,"value"],[1,"field","is-grouped"],["type","text",1,"input",3,"ngModelChange","ngModel"],[1,"control",2,"width","360px",3,"ngModelChange","ngModel"],["rows","2","placeholder","Escribe una observaci\xF3n",1,"textarea"],[1,"button","is-primary"],[3,"click","value"],[1,"button","is-primary",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0),C(1,"div",1),n(2,"div",2)(3,"header",3)(4,"p",4),l(5),D(6,"date"),o(),n(7,"button",5),h("click",function(){return i.cerrar()}),o()(),n(8,"div",6)(9,"div",7)(10,"div",8)(11,"label",9),l(12,"Tipo"),o(),n(13,"div",10)(14,"select",11),f("ngModelChange",function(a){return u(i.plan.tipo,a)||(i.plan.tipo=a),a}),n(15,"option",12),l(16,"Evento"),o(),n(17,"option",13),l(18,"Impulso"),o()()()()(),n(19,"div",7)(20,"div",8)(21,"label",14),l(22,"Cliente"),o(),n(23,"div",10)(24,"select",15),f("ngModelChange",function(a){return u(i.qlo,a)||(i.qlo=a),a}),h("change",function(a){return i.addCliente(a.target)}),y(25,re,2,6,"option",16,b),o()()()(),n(27,"div",17)(28,"div",8)(29,"label",14),l(30,"Ejec. de venta"),o(),n(31,"input",18),f("ngModelChange",function(a){return u(i.plan.ejecutivo,a)||(i.plan.ejecutivo=a),a}),o()(),n(32,"div",19),f("ngModelChange",function(a){return u(i.plan.observacion,a)||(i.plan.observacion=a),a}),C(33,"textarea",20),o()(),w(34,ce,3,0,"button",21),o()()()),e&2&&(T("ngClass",k(11,le,i.newPlanificacion)),d(5),M("Planificaci\xF3n ",i.plan.promotora," ",F(6,8,i.plan.fecha,"dd/MM/yyyy"),""),d(9),_("ngModel",i.plan.tipo),d(10),_("ngModel",i.qlo),d(),S(i.Clientes.clientes()),d(6),_("ngModel",i.plan.ejecutivo),d(),_("ngModel",i.plan.observacion),d(2),v(i.plan.cliente&&i.plan.ejecutivo?34:-1))},dependencies:[I,N,B,z,j,U,A,q,L,O],encapsulation:2})};var G=ee(te());var se=()=>[],de=c=>({"is-active":c});function me(c,r){c&1&&C(0,"app-loadings")}function pe(c,r){if(c&1){let e=x();n(0,"div",5)(1,"label",6),l(2,"\xA0"),o(),n(3,"button",29),h("click",function(){m(e);let t=s(2).$index,a=s(2);return p(a.removeMeta(t))}),n(4,"span",27),C(5,"i",30),o()()()}}function _e(c,r){if(c&1){let e=x();n(0,"div",5)(1,"label",6),l(2,"\xA0"),o(),n(3,"button",3),h("click",function(){m(e);let t=s(3);return p(t.addMeta())}),n(4,"span",27),C(5,"i",28),o()()(),w(6,pe,6,0,"div",5)}if(c&2){let e=s().$index;d(6),v(e>0?6:-1)}}function ue(c,r){if(c&1){let e=x();n(0,"div",4)(1,"div",5)(2,"label",6),l(3,"de (puntos)"),o(),n(4,"input",26),f("ngModelChange",function(t){let a=m(e).$index,g=s(2);return u(g.data.incentivos[a].de,t)||(g.data.incentivos[a].de=t),p(t)}),o()(),n(5,"div",5)(6,"label",6),l(7,"hasta (puntos)"),o(),n(8,"input",26),f("ngModelChange",function(t){let a=m(e).$index,g=s(2);return u(g.data.incentivos[a].hasta,t)||(g.data.incentivos[a].hasta=t),p(t)}),o()(),n(9,"div",5)(10,"label",6),l(11,"Incentivo (USD)"),o(),n(12,"input",26),f("ngModelChange",function(t){let a=m(e).$index,g=s(2);return u(g.data.incentivos[a].incentivo,t)||(g.data.incentivos[a].incentivo=t),p(t)}),o()(),w(13,_e,7,1),o()}if(c&2){let e=r.$index,i=s(2);d(4),_("ngModel",i.data.incentivos[e].de),d(4),_("ngModel",i.data.incentivos[e].hasta),d(4),_("ngModel",i.data.incentivos[e].incentivo),d(),v(e===i.metas-1?13:-1)}}function fe(c,r){if(c&1){let e=x();n(0,"span",2),l(1,"Plan mensual"),o(),C(2,"hr"),n(3,"div",4)(4,"div",5)(5,"label",6),l(6,"Mes"),o(),n(7,"div",7)(8,"select",8),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.mes,t)||(a.data.mes=t),p(t)}),n(9,"option",9),l(10,"Enero"),o(),n(11,"option",10),l(12,"Febrero"),o(),n(13,"option",11),l(14,"Marzo"),o(),n(15,"option",12),l(16,"Abril"),o(),n(17,"option",13),l(18,"Mayo"),o(),n(19,"option",14),l(20,"Junio"),o(),n(21,"option",15),l(22,"Julio"),o(),n(23,"option",16),l(24,"Agosto"),o(),n(25,"option",17),l(26,"Septiembre"),o(),n(27,"option",18),l(28,"Octubre"),o(),n(29,"option",19),l(30,"Noviembre"),o(),n(31,"option",20),l(32,"Diciembre"),o()()()(),n(33,"div",5)(34,"label",6),l(35,"Inicio"),o(),n(36,"input",21),h("change",function(){m(e);let t=s();return p(t.calcularSemanas())}),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.inicio,t)||(a.data.inicio=t),p(t)}),o()(),n(37,"div",5)(38,"label",6),l(39,"Cierre"),o(),n(40,"input",21),h("change",function(){m(e);let t=s();return p(t.calcularSemanas())}),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.cierre,t)||(a.data.cierre=t),p(t)}),o()()(),C(41,"hr"),n(42,"span",22),l(43,"Metas"),o(),C(44,"br")(45,"br"),n(46,"div",23)(47,"div",24)(48,"span",25),l(49,"Mystic (Promotoras fijas)"),o(),n(50,"div",4)(51,"div",5)(52,"label",6),l(53,"Impulso (Diario)"),o(),n(54,"input",26),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.metas.tradicional.mystic.impulso,t)||(a.data.metas.tradicional.mystic.impulso=t),p(t)}),o()(),n(55,"div",5)(56,"label",6),l(57,"Evento"),o(),n(58,"input",26),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.metas.tradicional.mystic.evento,t)||(a.data.metas.tradicional.mystic.evento=t),p(t)}),o()()(),n(59,"span",25),l(60,"Qerametik (Promotoras fijas)"),o(),n(61,"div",4)(62,"div",5)(63,"label",6),l(64,"Impulso (Diario)"),o(),n(65,"input",26),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.metas.tradicional.qerametik.impulso,t)||(a.data.metas.tradicional.qerametik.impulso=t),p(t)}),o()(),n(66,"div",5)(67,"label",6),l(68,"Evento"),o(),n(69,"input",26),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.metas.tradicional.qerametik.evento,t)||(a.data.metas.tradicional.qerametik.evento=t),p(t)}),o()()()(),n(70,"div",24)(71,"span",25),l(72,"Mystic (Promotoras por destajo)"),o(),n(73,"div",4)(74,"div",5)(75,"label",6),l(76,"Impulso (Diario)"),o(),n(77,"input",26),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.metas.rebranding.mystic.impulso,t)||(a.data.metas.rebranding.mystic.impulso=t),p(t)}),o()(),n(78,"div",5)(79,"label",6),l(80,"Evento"),o(),n(81,"input",26),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.metas.rebranding.mystic.evento,t)||(a.data.metas.rebranding.mystic.evento=t),p(t)}),o()()(),n(82,"span",25),l(83,"Qerametik (Promotoras por destajo)"),o(),n(84,"div",4)(85,"div",5)(86,"label",6),l(87,"Impulso (Diario)"),o(),n(88,"input",26),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.metas.rebranding.qerametik.impulso,t)||(a.data.metas.rebranding.qerametik.impulso=t),p(t)}),o()(),n(89,"div",5)(90,"label",6),l(91,"Evento"),o(),n(92,"input",26),f("ngModelChange",function(t){m(e);let a=s();return u(a.data.metas.rebranding.qerametik.evento,t)||(a.data.metas.rebranding.qerametik.evento=t),p(t)}),o()()()()(),C(93,"hr"),n(94,"span",22),l(95," Incentivos por ventas "),o(),C(96,"br")(97,"br"),y(98,ue,14,4,"div",4,b),C(100,"br")}if(c&2){let e=s();d(8),_("ngModel",e.data.mes),d(28),_("ngModel",e.data.inicio),d(4),_("ngModel",e.data.cierre),d(14),_("ngModel",e.data.metas.tradicional.mystic.impulso),d(4),_("ngModel",e.data.metas.tradicional.mystic.evento),d(7),_("ngModel",e.data.metas.tradicional.qerametik.impulso),d(4),_("ngModel",e.data.metas.tradicional.qerametik.evento),d(8),_("ngModel",e.data.metas.rebranding.mystic.impulso),d(4),_("ngModel",e.data.metas.rebranding.mystic.evento),d(7),_("ngModel",e.data.metas.rebranding.qerametik.impulso),d(4),_("ngModel",e.data.metas.rebranding.qerametik.evento),d(6),S(K(11,se).constructor(e.metas))}}function ge(c,r){if(c&1){let e=x();n(0,"li",34),h("click",function(){let t=m(e).$index,a=s(2);return p(a.semana_selected=t)}),n(1,"a"),l(2),o()()}if(c&2){let e=r.$index,i=s(2);T("ngClass",k(2,de,i.Aja(e))),d(2),W("Semana ",e+1,"")}}function Ce(c,r){if(c&1){let e=x();n(0,"button",37),h("click",function(){m(e);let t=s().$implicit,a=s(2).$implicit,g=s(2);return p(g.generarPlan(a.nombre,t.fecha))}),n(1,"span"),l(2,"Asignar Cliente"),o()()}}function he(c,r){if(c&1&&(n(0,"div",36),l(1," Asignado "),n(2,"div",38)(3,"b"),l(4,"Tipo: "),o(),l(5),C(6,"br"),n(7,"b"),l(8,"Cliente: "),o(),l(9),o()()),c&2){let e=s().$implicit,i=s(2).$implicit,t=s(2);d(5),W("",t.planification(e.fecha,i.nombre).tipo," "),d(4),W("",t.planification(e.fecha,i.nombre).cliente_nombre," ")}}function xe(c,r){if(c&1&&(n(0,"td"),l(1),D(2,"date"),w(3,Ce,3,0,"button",35)(4,he,10,2,"div",36),o()),c&2){let e=r.$implicit,i=s(2).$implicit,t=s(2);d(),M(" ",e.dia,": ",F(2,3,e.fecha,"dd/MM/yyyy")," "),d(2),v(t.existe(e.fecha,i.nombre)?4:3)}}function we(c,r){if(c&1&&y(0,xe,5,6,"td",null,b),c&2){let e=s(3);S(e.semanas[e.semana_selected])}}function ve(c,r){if(c&1&&(n(0,"thead")(1,"tr")(2,"th"),l(3),o(),C(4,"th")(5,"th")(6,"th")(7,"th")(8,"th")(9,"th"),o()(),n(10,"tbody")(11,"tr"),w(12,we,2,0),o()()),c&2){let e=r.$implicit,i=s(2);d(3),M("",e.nombre," ",e.apellido,""),d(9),v(i.semana_selected!==void 0?12:-1)}}function be(c,r){if(c&1&&(n(0,"div",31)(1,"ul"),y(2,ge,3,4,"li",32,b),o()(),n(4,"table",33),y(5,ve,13,3,null,null,b),o(),C(7,"br")),c&2){let e=s();d(2),S(e.semanas),d(3),S(e.promotoras.users())}}function ye(c,r){c&1&&(C(0,"br"),l(1,`
Aun no hay planificaci\xF3n semanal
`))}var Q=class c{servicePlanificacion=P($);promotoras=P(Z);clientes=P(J);aprobado=[];_aprobados_={};newPlanificacion=!1;active;onCloseModal=new E;plan={cliente:"",fecha:"",promotora:"",ejecutivo:"",observacion:"",tipo:"",cliente_nombre:""};data={mes:"",inicio:"",cierre:"",metas:{tradicional:{mystic:{impulso:0,evento:0},qerametik:{impulso:0,evento:0}},rebranding:{mystic:{impulso:0,evento:0},qerametik:{impulso:0,evento:0}}},incentivos:[{de:0,hasta:0,incentivo:0}],planificacion:[]};constructor(){setTimeout(()=>{this.servicePlanificacion.planificacion().length>0&&(this.data=this.servicePlanificacion.planificacion()[this.servicePlanificacion.planificacion().length-1],this.metas=this.data.incentivos.length,this.data.inicio=new Date(this.data.inicio).toISOString().slice(0,10),this.data.cierre=new Date(this.data.cierre).toISOString().slice(0,10),this.calcularSemanas(),console.log(this.data))},500)}metas=1;semana_selected=0;Aja(r){return r===this.semana_selected}semanas=[];calcularSemanas(){if(this.data.inicio&&this.data.cierre){let r=new Date(this.data.inicio),e=new Date(this.data.cierre),i=new Date(r),t=[],a=[];for(;i<=e;)a.push({dia:this.diaSemana(i.getDay()),fecha:new Date(i)}),a.length===7&&(t.push(a),a=[]),i.setDate(i.getDate()+1);a.length>0&&t.push(a),this.semanas=t,console.log(this.semanas)}}diaSemana(r){return["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"][r]}cerrar(){this.onCloseModal.emit()}addMeta(){this.metas++,this.data.incentivos.push({de:0,hasta:0,incentivo:0})}removeMeta(r){this.metas--,this.data.incentivos.length>1&&this.data.incentivos.splice(r,1)}sumarMetas(){this.metas++}crearPlanificacion(){console.log(this.data),this.servicePlanificacion.NuevaPlanificacion(this.data),setTimeout(()=>{G.default.fire({title:"Guardado cambios en la planificaci\xF3n",showConfirmButton:!1,timer:5e3,toast:!0,position:"top-end",timerProgressBar:!0,icon:"success"})},1e3),this.cerrar()}togle_Aprobados(r,e,i,t){if(this._aprobados_[r]||(this._aprobados_[r]=[]),this._aprobados_[r][e]=!this._aprobados_[r][e],!this.data.planificacion[i]){let a=new Date(t).toISOString().split("T")[0];this.data.planificacion[i]={fecha:a,cliente:""}}}generarPlan(r,e){let i=new Date(e),a=new Date(i.getTime()+0*60*60*1e3).toISOString();this.plan.promotora=r,this.plan.fecha=a,this.newPlanificacion=!0}cerrar_(){this.newPlanificacion=!1,this.plan={cliente:"",fecha:"",promotora:"",ejecutivo:"",observacion:"",tipo:"",cliente_nombre:""}}addplanificacion(){this.data.planificacion.push(this.plan),this.cerrar_(),console.log(this.data),G.default.fire({title:"Se agreg\xF3 plan a promotora",icon:"success",timer:5e3,showConfirmButton:!1,toast:!0,position:"top-end",timerProgressBar:!0})}existe(r,e){let i=new Date(r),a=new Date(i.getTime()+0*60*60*1e3).toISOString();return console.log(a),this.data.planificacion.some(g=>g.fecha==a&&g.promotora===e)}planification(r,e){let i=new Date(r),a=new Date(i.getTime()+0*60*60*1e3).toISOString();return this.data.planificacion.find(g=>g.fecha===a&&g.promotora===e)}existe_(r,e){return this.data.planificacion.some(i=>i.fecha==r&&i.promotora===e)}planification_(r,e){return this.data.planificacion.find(i=>i.fecha===r&&i.promotora===e)}planificacion(r,e){let i=new Date(r),a=new Date(i.getTime()+0*60*60*1e3).toISOString();return this.data.planificacion.filter(g=>g.fecha==a&&g.promotora===e)}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=V({type:c,selectors:[["app-planificacion"]],inputs:{active:"active"},outputs:{onCloseModal:"onCloseModal"},decls:13,vars:4,consts:[[3,"onCloseModal","onAgregarPlanificacion","newPlanificacion","plan"],[1,"banner"],[1,"title"],[1,"button","is-success",3,"click"],[1,"field","is-grouped"],[1,"control"],["for","",1,"label"],[1,"select"],[3,"ngModelChange","ngModel"],["value","Enero"],["value","Febrero"],["value","Marzo"],["value","Abril"],["value","Mayo"],["value","Junio"],["value","Julio"],["value","Agosto"],["value","Septiembre"],["value","Octubre"],["value","Noviembre"],["value","Diciembre"],["type","date","name","","id","",1,"input",3,"change","ngModelChange","ngModel"],[2,"font-size","x-large"],[1,"columns"],[1,"column"],[2,"font-weight","bolder"],["type","number","name","","id","",1,"input",3,"ngModelChange","ngModel"],[1,"icon"],[1,"fas","fa-plus"],[1,"button","is-danger",3,"click"],[1,"fas","fa-minus"],[1,"tabs"],[3,"ngClass"],[1,"table","is-fullwidth","is-striped"],[3,"click","ngClass"],[1,"button","is-primary"],[1,"asignado"],[1,"button","is-primary",3,"click"],[1,"popup"]],template:function(e,i){e&1&&(n(0,"app-new-planificacion",0),h("onCloseModal",function(){return i.cerrar_()})("onAgregarPlanificacion",function(){return i.addplanificacion()}),o(),n(1,"div",1),w(2,me,1,0,"app-loadings")(3,fe,101,12),o(),C(4,"hr"),n(5,"span",2),l(6,"planificacion por semana"),o(),w(7,be,8,0)(8,ye,2,0),C(9,"br"),n(10,"button",3),h("click",function(){return i.crearPlanificacion()}),n(11,"span"),l(12,"Guardar"),o()()),e&2&&(T("newPlanificacion",i.newPlanificacion)("plan",i.plan),d(2),v(i.servicePlanificacion.loading()?2:3),d(5),v(i.semanas.length>0?7:8))},dependencies:[z,j,U,A,X,q,L,O,I,N,B,Y,R],styles:['@charset "UTF-8";.asignado[_ngcontent-%COMP%]{position:relative;text-decoration:underline dotted;cursor:pointer}.asignado[_ngcontent-%COMP%]:hover   .popup[_ngcontent-%COMP%]{display:block}.popup[_ngcontent-%COMP%]{display:none;position:absolute;top:100%;left:50%;transform:translate(-50%);background-color:#fff;color:#333;padding:10px;border:1px solid #ccc;border-radius:5px;box-shadow:0 4px 6px #0000001a;z-index:100;white-space:nowrap}']})};export{Q as default};
