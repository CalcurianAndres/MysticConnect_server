import{a as se}from"./chunk-P2YCEQQ3.js";import{a as ne}from"./chunk-S3IGYESN.js";import{a as ae,b as oe}from"./chunk-O4VUAZ7E.js";import{a as L}from"./chunk-H4O6IPU4.js";import"./chunk-2LV7HNH4.js";import{a as W}from"./chunk-5A4UYOPG.js";import{b as A,c as j,d as R,e as ie,g as U,h as $,i as G,j as z}from"./chunk-NNPNTJPV.js";import"./chunk-TZTC4YCF.js";import{a as te}from"./chunk-UGQNDCKZ.js";import{$a as b,Ia as F,Na as S,Tb as N,Wa as E,Wb as q,X as y,Xa as Z,Ya as P,Za as v,Zb as O,_a as w,a as Y,ab as n,bb as a,cb as u,da as m,db as x,e as ce,ea as p,eb as f,fb as s,gb as Q,hb as ee,ib as r,ja as T,jb as k,kb as M,lb as D,nb as C,ob as g,pb as h,rb as H,sb as V,ub as B,wb as I,za as d}from"./chunk-BH4UYFV3.js";var le=c=>({"is-active":c});function ue(c,l){if(c&1){let e=x();n(0,"tr")(1,"td")(2,"i",28),f("click",function(){let t=m(e).$implicit,o=s();return p(o.addCliente_(t))}),a()(),n(3,"td"),r(4),a()()}if(c&2){let e=l.$implicit;d(4),k(e.cliente)}}function fe(c,l){if(c&1){let e=x();n(0,"option",29),f("click",function(){let t=m(e).$implicit,o=s();return p(o.plan.cliente_nombre=t.cliente)}),r(1),a()}if(c&2){let e=l.$implicit;ee("value","",e._id,"__",e.cliente,""),d(),M(" ",e.cliente,"")}}function Ce(c,l){if(c&1){let e=x();n(0,"button",30),f("click",function(){m(e);let t=s();return p(t.onAgregarPlanificacion.emit())}),n(1,"span"),r(2,"Listo"),a()()}}var J=class c{login=y(L);ClientServices=y(W);constructor(){setTimeout(()=>{this.plan.ejecutivo=`${this.login.usuario.nombre} ${this.login.usuario.apellido}`},1e3)}newPlanificacion;plan;onCloseModal=new T;onAgregarPlanificacion=new T;Clientes=y(W);qlo="";modalCliente=!1;filteredClientes=[];cerrar(){this.onCloseModal.emit()}addCliente_(l){let e=`${l._id}__${l.cliente}`;this.addCliente({value:e}),this.modalCliente=!1,this.newPlanificacion=!0}addCliente(l){let e=l.value.split("__"),i=e[0],t=e[1];console.log(i,t,"<3"),this.plan.cliente=i,this.plan.cliente_nombre=t,this.qlo=l.value}BuscarCliente(l){l.value.trim()===""?this.filteredClientes=[]:this.filteredClientes=this.ClientServices.clientes().filter(e=>e.cliente.toLowerCase().includes(l.value.toLowerCase())&&e.marca===this.login.usuario.marca)}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=F({type:c,selectors:[["app-new-planificacion"]],inputs:{newPlanificacion:"newPlanificacion",plan:"plan"},outputs:{onCloseModal:"onCloseModal",onAgregarPlanificacion:"onAgregarPlanificacion"},decls:59,vars:16,consts:[[1,"modal",3,"ngClass"],[1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-body"],[1,"title"],["type","text","name","","id","",1,"input",3,"input"],[1,"table","is-fullwidth","is-striped"],[1,"modal-background"],[1,"modal-card-head"],[1,"modal-card-title"],["aria-label","close",1,"delete",3,"click"],[1,"field"],[1,"control"],[1,"label"],[1,"select"],[3,"ngModelChange","ngModel"],["value","Evento"],["value","Impulso"],[1,"field","is-grouped"],["for","",1,"label"],[1,"button","is-success",3,"click"],[1,"icon"],[3,"ngModelChange","change","ngModel"],[3,"value"],["type","text","disabled","",1,"input",3,"ngModelChange","ngModel"],[1,"control",2,"width","360px",3,"ngModelChange","ngModel"],["rows","2","placeholder","Escribe una observaci\xF3n",1,"textarea"],[1,"button","is-primary"],[1,"fas","fa-plus",2,"color","rgb(100, 180, 100)",3,"click"],[3,"click","value"],[1,"button","is-primary",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1),f("click",function(){return i.modalCliente=!1,i.newPlanificacion=!0}),a(),n(2,"div",2)(3,"div",3)(4,"p",4),r(5,"Buscar cliente"),a(),n(6,"input",5),f("input",function(o){return i.BuscarCliente(o.target)}),a(),u(7,"hr"),n(8,"table",6)(9,"thead")(10,"tr"),u(11,"th"),n(12,"th"),r(13,"Clientes"),a()()(),n(14,"tbody"),w(15,ue,5,1,"tr",null,v),a()()()()(),n(17,"div",0),u(18,"div",7),n(19,"div",2)(20,"header",8)(21,"p",9),r(22),B(23,"date"),a(),n(24,"button",10),f("click",function(){return i.cerrar()}),a()(),n(25,"div",3)(26,"div",11)(27,"div",12)(28,"label",13),r(29,"Tipo"),a(),n(30,"div",14)(31,"select",15),h("ngModelChange",function(o){return g(i.plan.tipo,o)||(i.plan.tipo=o),o}),n(32,"option",16),r(33,"Evento"),a(),n(34,"option",17),r(35,"Impulso"),a()()()()(),n(36,"div",18)(37,"div",12)(38,"label",19),r(39,"Buscar"),a(),n(40,"button",20),f("click",function(){return i.newPlanificacion=!1,i.modalCliente=!0}),u(41,"span",21),a()(),n(42,"div",12)(43,"label",19),r(44,"Cliente"),a(),n(45,"div",14)(46,"select",22),h("ngModelChange",function(o){return g(i.qlo,o)||(i.qlo=o),o}),f("change",function(o){return i.addCliente(o.target)}),w(47,fe,2,4,"option",23,v),a()()()(),n(49,"div",18)(50,"div",12)(51,"label",19),r(52,"Ejec. de venta"),a(),n(53,"input",24),h("ngModelChange",function(o){return g(i.plan.ejecutivo,o)||(i.plan.ejecutivo=o),o}),a()()(),n(54,"div",11)(55,"div",12)(56,"div",25),h("ngModelChange",function(o){return g(i.plan.observacion,o)||(i.plan.observacion=o),o}),u(57,"textarea",26),a()()(),S(58,Ce,3,0,"button",27),a()()()),e&2&&(E("ngClass",V(12,le,i.modalCliente)),d(15),b(i.filteredClientes),d(2),E("ngClass",V(14,le,i.newPlanificacion)),d(5),D("Planificaci\xF3n ",i.plan.promotora," ",I(23,9,i.plan.fecha,"dd/MM/yyyy"),""),d(9),C("ngModel",i.plan.tipo),d(15),C("ngModel",i.qlo),d(),b(i.Clientes.clientes()),d(6),C("ngModel",i.plan.ejecutivo),d(3),C("ngModel",i.plan.observacion),d(2),P(i.plan.cliente&&i.plan.ejecutivo?58:-1))},dependencies:[O,N,q,z,$,G,A,U,j,R],encapsulation:2})};var K=ce(se());var re=()=>[],ge=c=>({"is-active":c});function he(c,l){c&1&&u(0,"app-loadings")}function xe(c,l){if(c&1&&(n(0,"option",34),r(1),a()),c&2){let e=l.$implicit,i=l.$index;Q("value",i),d(),k(e.mes)}}function ve(c,l){if(c&1&&(n(0,"option",34),r(1),a()),c&2){let e=l.$implicit;Q("value",e),d(),k(e)}}function we(c,l){if(c&1){let e=x();n(0,"div",6)(1,"select",33),f("change",function(t){m(e);let o=s(3);return p(o.cambiarPlanificacion(t.target))}),w(2,xe,2,2,"option",34,v),w(4,ve,2,2,"option",34,v),a()()}if(c&2){let e=s(3);d(2),b(e.servicePlanificacion.planificacion()),d(2),b(e.filtrarMese())}}function be(c,l){if(c&1){let e=x();n(0,"div",4)(1,"label",5),r(2,"\xA0"),a(),n(3,"button",38),f("click",function(){m(e);let t=s(2).$index,o=s(3);return p(o.removeMeta(t))}),n(4,"span",36),u(5,"i",39),a()()()}}function Se(c,l){if(c&1){let e=x();n(0,"div",4)(1,"label",5),r(2,"\xA0"),a(),n(3,"button",25),f("click",function(){m(e);let t=s(4);return p(t.addMeta())}),n(4,"span",36),u(5,"i",37),a()()(),S(6,be,6,0,"div",4)}if(c&2){let e=s().$index;d(6),P(e>0?6:-1)}}function Pe(c,l){if(c&1){let e=x();n(0,"div",26)(1,"div",4)(2,"label",5),r(3,"de (puntos)"),a(),n(4,"input",35),h("ngModelChange",function(t){let o=m(e).$index,_=s(3);return g(_.data.incentivos[o].de,t)||(_.data.incentivos[o].de=t),p(t)}),a()(),n(5,"div",4)(6,"label",5),r(7,"hasta (puntos)"),a(),n(8,"input",35),h("ngModelChange",function(t){let o=m(e).$index,_=s(3);return g(_.data.incentivos[o].hasta,t)||(_.data.incentivos[o].hasta=t),p(t)}),a()(),n(9,"div",4)(10,"label",5),r(11,"Incentivo (USD)"),a(),n(12,"input",35),h("ngModelChange",function(t){let o=m(e).$index,_=s(3);return g(_.data.incentivos[o].incentivo,t)||(_.data.incentivos[o].incentivo=t),p(t)}),a()(),S(13,Se,7,1),a()}if(c&2){let e=l.$index,i=s(3);d(4),C("ngModel",i.data.incentivos[e].de),d(4),C("ngModel",i.data.incentivos[e].hasta),d(4),C("ngModel",i.data.incentivos[e].incentivo),d(),P(e===i.metas-1?13:-1)}}function ye(c,l){if(c&1){let e=x();n(0,"div",4)(1,"label",5),r(2,"\xA0"),a(),n(3,"button",38),f("click",function(){m(e);let t=s(2).$index,o=s(3);return p(o.removeMeta_(t))}),n(4,"span",36),u(5,"i",39),a()()()}}function Me(c,l){if(c&1){let e=x();n(0,"div",4)(1,"label",5),r(2,"\xA0"),a(),n(3,"button",25),f("click",function(){m(e);let t=s(4);return p(t.addMeta_())}),n(4,"span",36),u(5,"i",37),a()()(),S(6,ye,6,0,"div",4)}if(c&2){let e=s().$index;d(6),P(e>0?6:-1)}}function Ee(c,l){if(c&1){let e=x();n(0,"div",26)(1,"div",4)(2,"label",5),r(3,"de (puntos)"),a(),n(4,"input",35),h("ngModelChange",function(t){let o=m(e).$index,_=s(3);return g(_.data.incentivos_qerametik[o].de,t)||(_.data.incentivos_qerametik[o].de=t),p(t)}),a()(),n(5,"div",4)(6,"label",5),r(7,"hasta (puntos)"),a(),n(8,"input",35),h("ngModelChange",function(t){let o=m(e).$index,_=s(3);return g(_.data.incentivos_qerametik[o].hasta,t)||(_.data.incentivos_qerametik[o].hasta=t),p(t)}),a()(),n(9,"div",4)(10,"label",5),r(11,"Incentivo (USD)"),a(),n(12,"input",35),h("ngModelChange",function(t){let o=m(e).$index,_=s(3);return g(_.data.incentivos_qerametik[o].incentivo,t)||(_.data.incentivos_qerametik[o].incentivo=t),p(t)}),a()(),S(13,Me,7,1),a()}if(c&2){let e=l.$index,i=s(3);d(4),C("ngModel",i.data.incentivos_qerametik[e].de),d(4),C("ngModel",i.data.incentivos_qerametik[e].hasta),d(4),C("ngModel",i.data.incentivos_qerametik[e].incentivo),d(),P(e===i.metas_-1?13:-1)}}function Te(c,l){if(c&1){let e=x();n(0,"span",2),r(1,"Plan mensual"),a(),u(2,"hr"),n(3,"div",26)(4,"div",4)(5,"label",5),r(6,"Mes"),a(),S(7,we,6,0,"div",6),a(),n(8,"div",4)(9,"label",5),r(10,"Inicio"),a(),n(11,"input",27),f("change",function(){m(e);let t=s(2);return p(t.calcularSemanas())}),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.inicio,t)||(o.data.inicio=t),p(t)}),a()(),n(12,"div",4)(13,"label",5),r(14,"Cierre"),a(),n(15,"input",27),f("change",function(){m(e);let t=s(2);return p(t.calcularSemanas())}),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.cierre,t)||(o.data.cierre=t),p(t)}),a()()(),u(16,"hr"),n(17,"span",28),r(18,"Metas"),a(),u(19,"br")(20,"br"),n(21,"div",29)(22,"div",30)(23,"span",31),r(24,"Mystic (Promotoras fijas)"),a(),n(25,"div",26)(26,"div",4)(27,"label",5),r(28,"Impulso (Diario)"),a(),n(29,"input",32),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.metas.tradicional.mystic.impulso,t)||(o.data.metas.tradicional.mystic.impulso=t),p(t)}),a()(),n(30,"div",4)(31,"label",5),r(32,"Evento"),a(),n(33,"input",32),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.metas.tradicional.mystic.evento,t)||(o.data.metas.tradicional.mystic.evento=t),p(t)}),a()()(),n(34,"span",31),r(35,"Qerametik (Promotoras fijas)"),a(),n(36,"div",26)(37,"div",4)(38,"label",5),r(39,"Impulso (Diario)"),a(),n(40,"input",32),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.metas.tradicional.qerametik.impulso,t)||(o.data.metas.tradicional.qerametik.impulso=t),p(t)}),a()(),n(41,"div",4)(42,"label",5),r(43,"Evento"),a(),n(44,"input",32),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.metas.tradicional.qerametik.evento,t)||(o.data.metas.tradicional.qerametik.evento=t),p(t)}),a()()()(),n(45,"div",30)(46,"span",31),r(47,"Mystic (Promotoras por destajo)"),a(),n(48,"div",26)(49,"div",4)(50,"label",5),r(51,"Impulso (Diario)"),a(),n(52,"input",32),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.metas.rebranding.mystic.impulso,t)||(o.data.metas.rebranding.mystic.impulso=t),p(t)}),a()(),n(53,"div",4)(54,"label",5),r(55,"Evento"),a(),n(56,"input",32),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.metas.rebranding.mystic.evento,t)||(o.data.metas.rebranding.mystic.evento=t),p(t)}),a()()(),n(57,"span",31),r(58,"Qerametik (Promotoras por destajo)"),a(),n(59,"div",26)(60,"div",4)(61,"label",5),r(62,"Impulso (Diario)"),a(),n(63,"input",32),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.metas.rebranding.qerametik.impulso,t)||(o.data.metas.rebranding.qerametik.impulso=t),p(t)}),a()(),n(64,"div",4)(65,"label",5),r(66,"Evento"),a(),n(67,"input",32),h("ngModelChange",function(t){m(e);let o=s(2);return g(o.data.metas.rebranding.qerametik.evento,t)||(o.data.metas.rebranding.qerametik.evento=t),p(t)}),a()()()()(),u(68,"hr"),n(69,"span",28),r(70," Incentivos por ventas "),a(),u(71,"br")(72,"br"),n(73,"div",29)(74,"div",30)(75,"span",2),r(76,"Incentivos Mystic"),a(),w(77,Pe,14,4,"div",26,v),a(),n(79,"div",30)(80,"span",2),r(81,"Incentivos Qerametik"),a(),w(82,Ee,14,4,"div",26,v),a()(),u(84,"br")}if(c&2){let e=s(2);d(7),P(e.servicePlanificacion.loading()?-1:7),d(4),C("ngModel",e.data.inicio),d(4),C("ngModel",e.data.cierre),d(14),C("ngModel",e.data.metas.tradicional.mystic.impulso),d(4),C("ngModel",e.data.metas.tradicional.mystic.evento),d(7),C("ngModel",e.data.metas.tradicional.qerametik.impulso),d(4),C("ngModel",e.data.metas.tradicional.qerametik.evento),d(8),C("ngModel",e.data.metas.rebranding.mystic.impulso),d(4),C("ngModel",e.data.metas.rebranding.mystic.evento),d(7),C("ngModel",e.data.metas.rebranding.qerametik.impulso),d(4),C("ngModel",e.data.metas.rebranding.qerametik.evento),d(10),b(H(11,re).constructor(e.metas)),d(5),b(H(12,re).constructor(e.metas_))}}function ke(c,l){if(c&1&&S(0,Te,85,13),c&2){let e=s();P(e.login.usuario.role!="Ejecutiva"?0:-1)}}function Ve(c,l){if(c&1){let e=x();n(0,"li",40),f("click",function(){let t=m(e).$index,o=s();return p(o.semana_selected=t)}),n(1,"a"),r(2),a()()}if(c&2){let e=l.$index,i=s();E("ngClass",V(2,ge,i.Aja(e))),d(2),M("Semana ",e+1,"")}}function We(c,l){if(c&1&&(n(0,"th",45),r(1),u(2,"br"),r(3),B(4,"date"),a()),c&2){let e=l.$implicit;d(),M(" ",e.dia," "),d(2),M(" ",I(4,2,e.fecha,"dd/MM")," ")}}function Fe(c,l){if(c&1){let e=x();n(0,"button",47),f("click",function(){m(e);let t=s().$implicit,o=s().$implicit,_=s();return p(_.generarPlan(o.nombre,t.fecha))}),n(1,"span",36),u(2,"i",37),a()()}}function De(c,l){if(c&1){let e=x();n(0,"span",48),f("click",function(){m(e);let t=s().$implicit,o=s().$implicit,_=s();return p(_.togglePopup(t.fecha,o.nombre))}),u(1,"i",49),a(),n(2,"span",50),f("click",function(){m(e);let t=s().$implicit,o=s().$implicit,_=s();return p(_.editarPlan(t.fecha,o.nombre))}),u(3,"i",51),a(),n(4,"div",52)(5,"div",53)(6,"p")(7,"strong"),r(8,"Tipo:"),a(),r(9),a(),n(10,"p")(11,"strong"),r(12,"Cliente:"),a(),r(13),a(),n(14,"button",54),f("click",function(){m(e);let t=s(3);return p(t.cerrarPopup())}),r(15,"Cerrar"),a()()()}if(c&2){let e=s().$implicit,i=s().$implicit,t=s();d(4),Z("show",t.isPopupOpen(e.fecha,i.nombre)),d(5),M(" ",t.planification(e.fecha,i.nombre).tipo,""),d(4),M(" ",t.planification(e.fecha,i.nombre).cliente_nombre,"")}}function Be(c,l){if(c&1&&(n(0,"td",45),S(1,Fe,3,0,"button",46)(2,De,16,4),a()),c&2){let e=l.$implicit,i=s().$implicit,t=s();d(),P(t.existe(e.fecha,i.nombre)?2:1)}}function Ie(c,l){if(c&1&&(n(0,"div",24)(1,"div",41)(2,"p",42),r(3),a()(),n(4,"div",43)(5,"table",44)(6,"thead")(7,"tr"),w(8,We,5,5,"th",45,v),a()(),n(10,"tbody")(11,"tr"),w(12,Be,3,1,"td",45,v),a()()()()()),c&2){let e=l.$implicit,i=s();d(3),D("",e.nombre," ",e.apellido,""),d(5),b(i.semanas[i.semana_selected]),d(4),b(i.semanas[i.semana_selected])}}var X=class c{servicePlanificacion=y(ae);promotoras=y(ne);clientes=y(W);login=y(L);reportes=y(oe);aprobado=[];_aprobados_={};newPlanificacion=!1;indexPlanificacion=0;Region="";active;onCloseModal=new T;plan={cliente:"",fecha:"",promotora:"",ejecutivo:"",observacion:"",tipo:"",cliente_nombre:""};data={mes:"",inicio:"",cierre:"",metas:{tradicional:{mystic:{impulso:0,evento:0},qerametik:{impulso:0,evento:0}},rebranding:{mystic:{impulso:0,evento:0},qerametik:{impulso:0,evento:0}}},incentivos:[{de:0,hasta:0,incentivo:0}],incentivos_qerametik:[{de:0,hasta:0,incentivo:0}],planificacion:[]};constructor(){setTimeout(()=>{this.servicePlanificacion.planificacion().length>0&&(this.Region=this.login.usuario.region,this.data=this.servicePlanificacion.planificacion()[this.servicePlanificacion.planificacion().length-1],this.metas=this.data.incentivos.length,this.metas_=this.data.incentivos_qerametik.length,this.data.inicio=new Date(this.data.inicio).toISOString().slice(0,10),this.data.cierre=new Date(this.data.cierre).toISOString().slice(0,10),this.calcularSemanas(),this.indexPlanificacion=this.servicePlanificacion.planificacion().length-1)},500)}metas=1;metas_=1;semana_selected=0;popupData=null;togglePopup(l,e){this.popupData?.fecha===l&&this.popupData?.nombre===e?this.popupData=null:this.popupData={fecha:l,nombre:e}}isPopupOpen(l,e){return this.popupData?.fecha===l&&this.popupData?.nombre===e}cerrarPopup(){this.popupData=null}editarPlan(l,e){console.log("Editar plan:",{fecha:l,nombre:e})}Aja(l){return l===this.semana_selected}semanas=[];calcularSemanas(){if(this.data.inicio&&this.data.cierre){let l=new Date(this.data.inicio),e=new Date(this.data.cierre),i=new Date(l),t=[],o=[];for(;i.getDay()!==0;)o.push({dia:this.diaSemana(i.getDay()),fecha:new Date(i)}),i.setDate(i.getDate()+1);for(o.length>0&&(t.push(o),o=[]);i<=e;)o.push({dia:this.diaSemana(i.getDay()),fecha:new Date(i)}),i.getDay()===6&&(t.push(o),o=[]),i.setDate(i.getDate()+1);o.length>0&&t.push(o),this.semanas=t,console.log(this.semanas)}}diaSemana(l){return["D","L","M","M","J","V","S"][l]}filtrarMese(){return["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"].filter(l=>!this.servicePlanificacion.planificacion().some(e=>e.mes===l))}cambiarPlanificacion(l){isNaN(Number(l.value))?(this.data.mes=l.value,this.data.inicio="",this.data.cierre="",this.data.planificacion=[],this.data._id&&delete this.data._id,this.semanas=[]):(this.data=Y({},this.servicePlanificacion.planificacion()[l.value]),this.data.inicio=this.servicePlanificacion.planificacion()[l.value].inicio.split("T")[0],this.data.cierre=this.servicePlanificacion.planificacion()[l.value].cierre.split("T")[0],this.calcularSemanas())}cerrar(){this.onCloseModal.emit()}addMeta(){this.metas++,this.data.incentivos.push({de:0,hasta:0,incentivo:0})}addMeta_(){this.metas_++,this.data.incentivos_qerametik.push({de:0,hasta:0,incentivo:0})}removeMeta(l){this.metas--,this.data.incentivos.length>1&&this.data.incentivos.splice(l,1)}removeMeta_(l){this.metas_--,this.data.incentivos_qerametik.length>1&&this.data.incentivos_qerametik.splice(l,1)}sumarMetas(){this.metas++}crearPlanificacion(){console.log(this.data),this.servicePlanificacion.NuevaPlanificacion(this.data),setTimeout(()=>{K.default.fire({title:"Guardado cambios en la planificaci\xF3n",showConfirmButton:!1,timer:5e3,toast:!0,position:"top-end",timerProgressBar:!0,icon:"success"})},1e3),this.cerrar()}togle_Aprobados(l,e,i,t){if(this._aprobados_[l]||(this._aprobados_[l]=[]),this._aprobados_[l][e]=!this._aprobados_[l][e],!this.data.planificacion[i]){let o=new Date(t).toISOString().split("T")[0];this.data.planificacion[i]={fecha:o,cliente:""}}}generarPlan(l,e){let i=new Date(e),o=new Date(i.getTime()+0*60*60*1e3).toISOString();this.plan.promotora=l,this.plan.fecha=o,this.newPlanificacion=!0}cerrar_(){this.newPlanificacion=!1,this.plan={cliente:"",fecha:"",promotora:"",ejecutivo:"",observacion:"",tipo:"",cliente_nombre:""}}addplanificacion(){this.data.planificacion.push(this.plan),this.servicePlanificacion.NuevaPlanificacion(this.data),this.cerrar_(),K.default.fire({title:"Se agreg\xF3 plan a promotora",icon:"success",timer:5e3,showConfirmButton:!1,toast:!0,position:"top-end",timerProgressBar:!0})}existe(l,e){let i=new Date(l),o=new Date(i.getTime()+0*60*60*1e3).toISOString();return this.data.planificacion.some(_=>_.fecha==o&&_.promotora===e)}planification(l,e){let i=new Date(l),o=new Date(i.getTime()+0*60*60*1e3).toISOString();return this.data.planificacion.find(_=>_.fecha===o&&_.promotora===e)}existe_(l,e){return this.data.planificacion.some(i=>i.fecha==l&&i.promotora===e)}planification_(l,e){return this.data.planificacion.find(i=>i.fecha===l&&i.promotora===e)}planificacion(l,e){let i=new Date(l),o=new Date(i.getTime()+0*60*60*1e3).toISOString();return this.data.planificacion.filter(_=>_.fecha==o&&_.promotora===e)}FiltroPorRegion(){return this.promotoras.users().filter(l=>l.region===this.Region)}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=F({type:c,selectors:[["app-planificacion"]],inputs:{active:"active"},outputs:{onCloseModal:"onCloseModal"},decls:55,vars:4,consts:[[3,"onCloseModal","onAgregarPlanificacion","newPlanificacion","plan"],[1,"banner"],[1,"title"],[1,"field"],[1,"control"],["for","",1,"label"],[1,"select"],[3,"ngModelChange","ngModel"],["value","Barcelona"],["value","Barquisimeto"],["value","Cumana"],["value","Gran Caracas"],["value","Guaira"],["value","Guarenas"],["value","Maracay"],["value","Maracaibo"],["value","Merida"],["value","Puerto Ordaz"],["value","Pto. Ordaz"],["value","Tachira"],["value","Valencia"],["value","Valera"],[1,"tabs"],[3,"ngClass"],[1,"card"],[1,"button","is-success",3,"click"],[1,"field","is-grouped"],["type","date","name","","id","",1,"input",3,"change","ngModelChange","ngModel"],[2,"font-size","x-large"],[1,"columns"],[1,"column"],[2,"font-weight","bolder"],["type","number","name","","id","",1,"input",3,"ngModelChange","ngModel"],[3,"change"],[3,"value"],["type","number","name","","id","",1,"input",2,"width","100px",3,"ngModelChange","ngModel"],[1,"icon"],[1,"fas","fa-plus"],[1,"button","is-danger",3,"click"],[1,"fas","fa-minus"],[3,"click","ngClass"],[1,"card-header"],[1,"card-header-title"],[1,"card-content"],[1,"table","is-fullwidth","is-striped"],[2,"text-align","center"],[1,"button","is-success","is-small"],[1,"button","is-success","is-small",3,"click"],[1,"icon","info-icon",3,"click"],[1,"fas","fa-info-circle"],[1,"icon","edit-icon",3,"click"],[1,"fas","fa-edit"],[1,"popup"],[1,"popup-content"],[1,"button","is-small","is-danger",3,"click"]],template:function(e,i){e&1&&(n(0,"app-new-planificacion",0),f("onCloseModal",function(){return i.cerrar_()})("onAgregarPlanificacion",function(){return i.addplanificacion()}),a(),n(1,"div",1),S(2,he,1,0,"app-loadings")(3,ke,1,1),a(),u(4,"br"),n(5,"span",2),r(6,"Planificaci\xF3n por semana"),a(),u(7,"br")(8,"br"),n(9,"div",3)(10,"div",4)(11,"label",5),r(12,"Selecciona regi\xF3n"),a(),n(13,"div",6)(14,"select",7),h("ngModelChange",function(o){return g(i.Region,o)||(i.Region=o),o}),n(15,"option",8),r(16,"Barcelona"),a(),n(17,"option",9),r(18,"Barquisimeto"),a(),n(19,"option",10),r(20,"Cumana"),a(),n(21,"option",11),r(22,"Gran Caracas"),a(),n(23,"option",12),r(24,"Guaira"),a(),n(25,"option",13),r(26,"Guarenas"),a(),n(27,"option",14),r(28,"Maracay"),a(),n(29,"option",15),r(30,"Maracaibo"),a(),n(31,"option",16),r(32,"Merida"),a(),n(33,"option",17),r(34,"Puerto Ordaz"),a(),n(35,"option",18),r(36,"Pto. Ordaz"),a(),n(37,"option",19),r(38,"Tachira"),a(),n(39,"option",20),r(40,"Valencia"),a(),n(41,"option",21),r(42,"Valera"),a()()()()(),u(43,"br")(44,"br"),n(45,"div",22)(46,"ul"),w(47,Ve,3,4,"li",23,v),a()(),w(49,Ie,14,2,"div",24,v),u(51,"br"),n(52,"button",25),f("click",function(){return i.crearPlanificacion()}),n(53,"span"),r(54,"Guardar"),a()()),e&2&&(E("newPlanificacion",i.newPlanificacion)("plan",i.plan),d(2),P(i.servicePlanificacion.loading()?2:3),d(12),C("ngModel",i.Region),d(33),b(i.semanas),d(2),b(i.FiltroPorRegion()))},dependencies:[z,$,G,A,ie,U,j,R,O,N,q,te,J],styles:['@charset "UTF-8";.asignado[_ngcontent-%COMP%]{position:relative;text-decoration:underline dotted;cursor:pointer}.asignado[_ngcontent-%COMP%]:hover   .popup[_ngcontent-%COMP%]{display:block}.popup[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border:1px solid #ccc;box-shadow:0 4px 8px #0003;border-radius:8px;padding:16px;display:none;z-index:10000}.popup.show[_ngcontent-%COMP%]{display:block}.popup-content[_ngcontent-%COMP%]{text-align:center}.info-icon[_ngcontent-%COMP%]{color:#007bff;cursor:pointer;margin-right:8px}.edit-icon[_ngcontent-%COMP%]{color:#ffc107;cursor:pointer}.popup[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin-top:8px}']})};export{X as default};
