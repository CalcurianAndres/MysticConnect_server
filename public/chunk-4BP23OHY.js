import{a as ie}from"./chunk-P2YCEQQ3.js";import{a as $,b as ee}from"./chunk-4YLB6BMN.js";import{a as j}from"./chunk-H4O6IPU4.js";import"./chunk-2LV7HNH4.js";import{a as K}from"./chunk-4DQSAP2D.js";import{a as X}from"./chunk-5A4UYOPG.js";import{b as q,c as U,d as Q,e as z,f as G,g as H,h as J,i as Y,j as Z}from"./chunk-NNPNTJPV.js";import"./chunk-TZTC4YCF.js";import{$a as M,Fa as E,Ia as I,Na as x,Tb as N,Wa as b,X as S,Ya as v,Za as w,Zb as O,_a as y,ab as n,bb as o,cb as m,da as p,db as f,e as te,ea as _,eb as h,fb as d,gb as F,ib as s,jb as V,kb as L,lb as P,mb as D,nb as u,ob as C,pb as g,sb as W,tb as A,za as c}from"./chunk-BH4UYFV3.js";var R=te(ie());var ne=r=>({"is-active":r}),oe=r=>({rotado:r}),ae=(r,i)=>({oculto:r,activo:i});function re(r,i){if(r&1){let e=f();n(0,"tr")(1,"td")(2,"i",29),h("click",function(){let t=p(e).$implicit,a=d();return _(a.addCliente(t._id))}),o()(),n(3,"td"),s(4),o()()}if(r&2){let e=i.$implicit;c(4),V(e.cliente)}}function le(r,i){if(r&1&&(n(0,"option",34),s(1),o()),r&2){let e=i.$implicit;F("value",e._id),c(),V(e.cliente)}}function ce(r,i){if(r&1){let e=f();n(0,"div",14)(1,"label",23),s(2,"\xA0"),o(),n(3,"button",30),h("click",function(){p(e);let t=d();return _(t.modalCliente=!0)}),n(4,"span",31),m(5,"i",32),o()()(),n(6,"div",14)(7,"label",23),s(8,"Establecimiento"),o(),n(9,"div",24)(10,"select",33),g("ngModelChange",function(t){p(e);let a=d();return C(a.establecimiento,t)||(a.establecimiento=t),_(t)}),y(11,le,2,2,"option",34,w),o()()()}if(r&2){let e=d();c(3),b("disabled",e.planificado),c(7),u("ngModel",e.establecimiento),b("disabled",e.planificado),c(),M(e.ClientServices.clientes())}}function se(r,i){if(r&1){let e=f();n(0,"div",14)(1,"label",23),s(2,"Motivo"),o(),n(3,"div",24)(4,"select",35),g("ngModelChange",function(t){p(e);let a=d();return C(a.establecimiento,t)||(a.establecimiento=t),_(t)}),n(5,"option",36),s(6,"Reposo Medico"),o(),n(7,"option",37),s(8,"Malestar"),o(),n(9,"option",38),s(10,"Asunto Personal"),o()()()()}if(r&2){let e=d();c(4),u("ngModel",e.establecimiento)}}function de(r,i){if(r&1){let e=f();n(0,"div",16)(1,"div",9)(2,"div",13)(3,"div",14)(4,"input",42),g("ngModelChange",function(t){p(e);let a=d(3);return C(a.tipo_evento,t)||(a.tipo_evento=t),_(t)}),o(),s(5," Juega y Gana "),o(),n(6,"div",14)(7,"input",43),g("ngModelChange",function(t){p(e);let a=d(3);return C(a.tipo_evento,t)||(a.tipo_evento=t),_(t)}),o(),s(8," Color y estilo "),o()(),n(9,"div",13)(10,"div",14)(11,"input",44),g("ngModelChange",function(t){p(e);let a=d(3);return C(a.tipo_evento,t)||(a.tipo_evento=t),_(t)}),o(),s(12," Cabellos con estilo "),o(),n(13,"div",14)(14,"input",45),g("ngModelChange",function(t){p(e);let a=d(3);return C(a.tipo_evento,t)||(a.tipo_evento=t),_(t)}),o(),s(15," Dale y gana "),o()()()()}if(r&2){let e=d(3);c(4),u("ngModel",e.tipo_evento),c(3),u("ngModel",e.tipo_evento),c(4),u("ngModel",e.tipo_evento),c(3),u("ngModel",e.tipo_evento)}}function pe(r,i){if(r&1){let e=f();n(0,"div",9)(1,"div",13)(2,"div",14)(3,"input",46),g("ngModelChange",function(t){p(e);let a=d(3);return C(a.tipo_evento,t)||(a.tipo_evento=t),_(t)}),o(),s(4," Qerastyle "),o(),n(5,"div",14)(6,"input",47),g("ngModelChange",function(t){p(e);let a=d(3);return C(a.tipo_evento,t)||(a.tipo_evento=t),_(t)}),o(),s(7," Ruleta "),o()()()}if(r&2){let e=d(3);c(3),u("ngModel",e.tipo_evento),c(3),u("ngModel",e.tipo_evento)}}function _e(r,i){if(r&1&&x(0,de,16,4,"div",16)(1,pe,8,2,"div",9),r&2){let e=d(2);v(e.marca_seleccionada==="Mystic"?0:1)}}function me(r,i){if(r&1){let e=f();n(0,"button",49),h("click",function(){p(e);let t=d(3);return _(t.NextStep())}),n(1,"span",31),m(2,"i",50),o(),n(3,"span"),s(4,"Continuar"),o()()}}function ue(r,i){if(r&1){let e=f();n(0,"button",49),h("click",function(){p(e);let t=d(3);return _(t.NextStep())}),n(1,"span",31),m(2,"i",50),o(),n(3,"span"),s(4,"Continuar"),o()()}}function Ce(r,i){if(r&1&&x(0,me,5,0,"button",48)(1,ue,5,0,"button",48),r&2){let e=d(2);v(e.tipo!="Evento"?0:e.tipo_evento?1:-1)}}function ge(r,i){if(r&1){let e=f();n(0,"div",13)(1,"div",14)(2,"label",39)(3,"input",40),g("ngModelChange",function(t){p(e);let a=d();return C(a.tipo,t)||(a.tipo=t),_(t)}),o(),s(4," Impulso "),o()(),n(5,"div",14)(6,"label",39)(7,"input",41),g("ngModelChange",function(t){p(e);let a=d();return C(a.tipo,t)||(a.tipo=t),_(t)}),o(),s(8," Evento "),o()()(),x(9,_e,2,1)(10,Ce,2,1)}if(r&2){let e=d();c(3),u("ngModel",e.tipo),c(4),u("ngModel",e.tipo),c(2),v(e.tipo==="Evento"?9:-1),c(),v(e.establecimiento&&e.tipo&&e.marca_seleccionada?10:-1)}}function fe(r,i){if(r&1){let e=f();n(0,"button",49),h("click",function(){p(e);let t=d(2);return _(t.reportarFalta())}),n(1,"span",31),m(2,"i",50),o(),n(3,"span"),s(4,"Reportar"),o()()}}function he(r,i){if(r&1&&x(0,fe,5,0,"button",48),r&2){let e=d();v(e.establecimiento?0:-1)}}function ve(r,i){if(r&1){let e=f();n(0,"tr")(1,"td",55)(2,"button",56),h("click",function(){let t=p(e).$implicit,a=d(2);return _(a.agregarProducto(t._id))}),n(3,"span",31),m(4,"i",57),o()()(),n(5,"td"),s(6),o()()}if(r&2){let e=i.$implicit;c(6),P("",e.producto," (",e.linea,")")}}function xe(r,i){r&1&&(n(0,"thead")(1,"tr"),m(2,"th"),n(3,"th"),s(4,"Producto"),o(),n(5,"th"),s(6,"Alm. Inicial"),o(),n(7,"th"),s(8,"Alm. Final"),o()()())}function be(r,i){if(r&1){let e=f();n(0,"tr")(1,"td",55)(2,"button",58),h("click",function(){let t=p(e).$index,a=d(2);return _(a.eliminarDeProductosSelected(t))}),n(3,"span",31),m(4,"i",59),o()()(),n(5,"td"),s(6),o(),n(7,"td",60)(8,"input",61),g("ngModelChange",function(t){let a=p(e).$implicit;return C(a.inicial,t)||(a.inicial=t),_(t)}),o()(),n(9,"td",60)(10,"input",61),g("ngModelChange",function(t){let a=p(e).$implicit;return C(a.final,t)||(a.final=t),_(t)}),o()()()}if(r&2){let e=i.$implicit;c(6),D("",e.producto.marca," - ",e.producto.producto," (",e.producto.linea,")"),c(2),u("ngModel",e.inicial),c(2),u("ngModel",e.final)}}function Se(r,i){r&1&&(n(0,"div",54),s(1," Aun no haz indicado ningun producto para reportar su venta. "),o())}function we(r,i){if(r&1){let e=f();n(0,"div",51)(1,"div",14)(2,"textarea",62),g("ngModelChange",function(t){p(e);let a=d(2);return C(a.obervacion,t)||(a.obervacion=t),_(t)}),o()()()}if(r&2){let e=d(2);c(2),u("ngModel",e.obervacion)}}function ye(r,i){if(r&1){let e=f();n(0,"button",49),h("click",function(){p(e);let t=d(2);return _(t.Reportar())}),n(1,"span",31),m(2,"i",63),o(),n(3,"span"),s(4,"Reportar"),o()()}}function Me(r,i){if(r&1){let e=f();n(0,"div",16)(1,"div",9)(2,"div",51)(3,"div",14)(4,"label",23),s(5,"Buscado de productos"),o(),n(6,"input",52),g("ngModelChange",function(t){p(e);let a=d();return C(a.searchTerm,t)||(a.searchTerm=t),_(t)}),h("input",function(){p(e);let t=d();return _(t.filterProductos())}),o()()(),m(7,"hr"),n(8,"table",53)(9,"thead"),y(10,ve,7,2,"tr",null,w),o()(),n(12,"table",6),x(13,xe,9,0,"thead"),n(14,"tbody"),y(15,be,11,5,"tr",null,w,!1,Se,2,0,"div",54),o()(),x(18,we,3,1,"div",51)(19,ye,5,0,"button",48),o()()}if(r&2){let e=d();c(6),u("ngModel",e.searchTerm),c(4),M(e.filteredProductos),c(3),v(e.ProductosSelected.length>0?13:-1),c(2),M(e.ProductosSelected),c(3),v(e.ProductosSelected.length>0?18:-1),c(),v(e.ProductosSelected.length>0&&e.VerificarReporte()&&e.obervacion?19:-1)}}var B=class r{ClientServices=S(X);ProductosServices=S(K);ReportesServices=S(ee);loginSevice=S(j);planificacion=S($);searchTerm="";filteredProductos=[];filteredClientes=[];Informacion=E(!0);isRotated=E(!1);ProductosSelected=[];establecimiento="";tipo="";tipo_evento="";obervacion="";date_log="";CargadaInformacion=E(!1);usarListaAntigua=!1;data={promotora:this.loginSevice.usuario._id,cliente:"",productos:[],tipo:"",observacion:"",fecha:this.date_log};date_aja;marca_seleccionada="";cliente="";modalCliente=!1;estab=!1;planificado=!1;constructor(){this.date_log=this.getFormattedDate(),this.date_aja=new Date}addCliente(i){i?this.establecimiento=i:this.establecimiento="",this.modalCliente=!1}filterProductos(){this.searchTerm.trim()===""?this.filteredProductos=[]:this.usarListaAntigua?this.filteredProductos=this.ProductosServices.productos().filter(i=>i.producto.toLowerCase().includes(this.searchTerm.toLowerCase())&&i.marca===this.marca_seleccionada&&i.linea==="Antigua"):this.filteredProductos=this.ProductosServices.productos().filter(i=>i.producto.toLowerCase().includes(this.searchTerm.toLowerCase())&&i.marca===this.marca_seleccionada&&i.linea!="Antigua")}BuscarCliente(i){i.value.trim()===""?this.filteredClientes=[]:this.filteredClientes=this.ClientServices.clientes().filter(e=>e.cliente.toLowerCase().includes(i.value.toLowerCase())&&e.marca===this.marca_seleccionada)}getFormattedDate(){let i=new Date,e=String(i.getDate()).padStart(2,"0"),l=String(i.getMonth()+1).padStart(2,"0"),t=i.getFullYear(),a=i.getHours(),k=String(i.getMinutes()).padStart(2,"0"),T=String(i.getSeconds()).padStart(2,"0"),Re=a>=12?"PM":"AM";return a=a%12,a=a||12,`${t}-${l}-${e}`}toggleInformacion(){this.Informacion.update(i=>!i),this.isRotated.update(i=>!i)}agregarProducto(i){let e=this.ProductosServices.productos().find(t=>t._id===i);if(!e){console.error("Producto no encontrado");return}this.ProductosSelected.some(t=>t.producto?._id===e._id)||this.ProductosSelected.push({producto:e,inicial:0,final:0})}VerificarReporte(){return this.ProductosSelected.every(i=>i.inicial>0&&i.inicial>0&&i.final<=i.inicial)}eliminarDeProductosSelected(i){this.ProductosSelected.splice(i,1)}resta=(i,e)=>i-e;Reportar(){R.default.fire({title:"\xBFReportar ventas de hoy?",text:"Recuerda verificar bien las cantidades que declaras y los productos seleccionados",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Reportar!"}).then(i=>{i.isConfirmed&&(R.default.fire({title:"Listo",text:"La informaci\xF3n fue enviada con exito",icon:"success",showConfirmButton:!1,timer:5e3,toast:!0,timerProgressBar:!0,position:"top-end"}),this.data.cliente=this.establecimiento,this.data.tipo=this.tipo,this.data.evento=this.tipo_evento,this.data.productos=this.ProductosSelected.map(e=>({producto:e.producto._id,inicio:e.inicial,final:e.final,cantidad:this.resta(e.inicial,e.final)})),this.data.observacion=this.obervacion,this.data.fecha=this.date_log,this.ReportesServices.NuevoReporte(this.data),this.data={promotora:this.loginSevice.usuario._id,cliente:"",productos:[],tipo:"",observacion:"",fecha:this.date_log},this.ProductosSelected=[],this.establecimiento="",this.tipo="",this.tipo_evento="",this.obervacion="",this.CargadaInformacion.update(e=>!1),this.isRotated.update(e=>!1),this.Informacion.update(e=>!0))})}reportarFalta(){R.default.fire({title:"\xBFReportar falta el dia de hoy?",text:"No generaras puntos ni ventas el dia de hoy",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Reportar!"}).then(i=>{i.isConfirmed&&(R.default.fire({title:"Listo",text:"La informaci\xF3n fue enviada con exito",icon:"success",showConfirmButton:!1,timer:5e3,toast:!0,timerProgressBar:!0,position:"top-end"}),this.data.cliente="6756ef7ed60449fa9c3ee3fa",this.data.tipo=this.establecimiento,this.data.evento=this.tipo_evento,this.data.productos=[],this.data.observacion="Promotora reporto falta justificada por lo que no pudo realizar ventas hoy",this.data.fecha=this.date_log,this.ReportesServices.NuevoReporte(this.data),this.data={promotora:this.loginSevice.usuario._id,cliente:"",productos:[],tipo:"",observacion:"",fecha:this.date_log},this.ProductosSelected=[],this.establecimiento="",this.tipo="",this.tipo_evento="",this.obervacion="",this.CargadaInformacion.update(e=>!1),this.isRotated.update(e=>!1),this.Informacion.update(e=>!0))})}NextStep(){this.CargadaInformacion.update(i=>!0),this.isRotated.update(i=>!0),this.Informacion.update(i=>!1)}verFormato(i){console.log(i.value)}planification(i,e){let l=new Date(i),t=new Date(l.getTime()+0*60*60*1e3),a=t.toISOString();t.setUTCDate(i.getUTCDate()+1),t.setUTCHours(0,0,0,0);let k=t.toISOString();return this.planificacion.planificacion()[this.planificacion.planificacion().length-1].planificacion.find(T=>T.fecha===k&&T.promotora===e)}buscarClientePorNombre(){this.estab=!1,this.planificado=!1,setTimeout(()=>{if(this.planification(this.date_aja,this.loginSevice.usuario.nombre)){let i=this.planification(this.date_aja,this.loginSevice.usuario.nombre).cliente_nombre;this.establecimiento=this.ClientServices.clientes().find(e=>e.marca===this.marca_seleccionada&&e.cliente===i)?._id,this.establecimiento!=null&&(this.tipo=this.planification(this.date_aja,this.loginSevice.usuario.nombre).tipo,this.planificado=!0),this.estab=!0}else this.estab=!0},1e3)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=I({type:r,selectors:[["app-reporte"]],decls:57,vars:19,consts:[[1,"modal",3,"ngClass"],[1,"modal-background"],[1,"modal-card"],[1,"modal-card-body"],[1,"title"],["type","text","name","","id","",1,"input",3,"input"],[1,"table","is-fullwidth","is-striped"],[1,"formulario_envio_informacion"],[1,"card",2,"background-color","#34495E","color","rgb(212, 212, 212)"],[1,"card-content"],[1,"title",2,"color","rgb(212, 212, 212)"],[2,"font-weight","bold"],[1,"subtitle",2,"color","rgb(212, 212, 212)"],[1,"field","is-grouped"],[1,"control"],["type","date","disabled","",1,"input",3,"ngModelChange","change","ngModel","max"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["aria-label","more options",1,"card-header-icon"],[1,"icon",3,"click","ngClass"],["aria-hidden","true",1,"fas","fa-angle-up"],[1,"card-content",3,"ngClass"],["for","",1,"label"],[1,"select"],[3,"ngModelChange","change","ngModel"],["value","Mystic"],["value","Qerametik"],["value","Falta"],[1,"fas","fa-plus",2,"color","rgb(100, 180, 100)",3,"click"],[1,"button","is-success",3,"click","disabled"],[1,"icon"],[1,"fas","fa-search"],[3,"ngModelChange","ngModel","disabled"],[3,"value"],[3,"ngModelChange","ngModel"],["value","Reposo"],["value","Malestar"],["value","Asunto personal"],[1,"radio"],["type","radio","name","evento","value","Impulso",3,"ngModelChange","ngModel"],["type","radio","name","evento","value","Evento",3,"ngModelChange","ngModel"],["type","radio","name","Tipo_evento","value","Juega y Gana",3,"ngModelChange","ngModel"],["type","radio","name","Tipo_evento","value","Color y estilo",3,"ngModelChange","ngModel"],["type","radio","name","Tipo_evento","value","Cabellos con estilo",3,"ngModelChange","ngModel"],["type","radio","name","Tipo_evento","value","Dale y gana",3,"ngModelChange","ngModel"],["type","radio","name","Tipo_evento","value","Qerastyle",3,"ngModelChange","ngModel"],["type","radio","name","Tipo_evento","value","Ruleta",3,"ngModelChange","ngModel"],[1,"button","is-primary"],[1,"button","is-primary",3,"click"],[1,"fas","fa-long-arrow-alt-right"],[1,"field"],["type","text","placeholder","Buscar producto",1,"input",3,"ngModelChange","input","ngModel"],[1,"table","is-fullwidth","is-hoverable","is-striped"],[1,"notification","is-primary","is-light"],[2,"width","15px"],[1,"button","is-success","is-small","is-outlined",2,"border","none",3,"click"],[1,"fas","fa-plus-square"],[1,"button","is-danger","is-small","is-outlined",2,"border","none",3,"click"],[1,"fas","fa-trash-alt"],[2,"width","100px"],["type","number","placeholde","Cantidad vendida",1,"input",3,"ngModelChange","ngModel"],["placeholder","Observaci\xF3n",1,"textarea",3,"ngModelChange","ngModel"],[1,"fas","fa-check"]],template:function(e,l){e&1&&(n(0,"div",0),m(1,"div",1),n(2,"div",2)(3,"div",3)(4,"p",4),s(5,"Buscar cliente"),o(),n(6,"input",5),h("input",function(a){return l.BuscarCliente(a.target)}),o(),m(7,"hr"),n(8,"table",6)(9,"thead")(10,"tr"),m(11,"th"),n(12,"th"),s(13,"Clientes"),o()()(),n(14,"tbody"),y(15,re,5,1,"tr",null,w),o()()()()(),n(17,"div",7)(18,"div",8)(19,"div",9)(20,"span",10),s(21),o(),m(22,"br"),n(23,"b",11),s(24,"Zona: "),o(),s(25),m(26,"br"),n(27,"span",12)(28,"div",13)(29,"div",14)(30,"input",15),g("ngModelChange",function(a){return C(l.date_log,a)||(l.date_log=a),a}),h("change",function(a){return l.verFormato(a.target)}),o()()()()()(),m(31,"hr"),n(32,"div",16)(33,"header",17)(34,"p",18),s(35,"Informaci\xF3n del reporte"),o(),n(36,"button",19)(37,"span",20),h("click",function(){return l.toggleInformacion()}),m(38,"i",21),o()()(),n(39,"div",22)(40,"div",13)(41,"div",14)(42,"label",23),s(43,"Marca"),o(),n(44,"div",24)(45,"select",25),g("ngModelChange",function(a){return C(l.marca_seleccionada,a)||(l.marca_seleccionada=a),a}),h("change",function(){return l.buscarClientePorNombre()}),n(46,"option",26),s(47,"Mystic"),o(),n(48,"option",27),s(49,"Qerametik"),o(),n(50,"option",28),s(51,"Falta"),o()()()(),x(52,ce,13,3)(53,se,11,1,"div",14),o(),x(54,ge,11,4)(55,he,1,1),o()(),x(56,Me,20,5,"div",16),o()),e&2&&(b("ngClass",W(12,ne,l.modalCliente)),c(15),M(l.filteredClientes),c(6),P(" ",l.loginSevice.usuario.nombre," ",l.loginSevice.usuario.apellido," "),c(4),L("",l.loginSevice.usuario.region," "),c(5),u("ngModel",l.date_log),b("max",l.date_log),c(7),b("ngClass",W(14,oe,l.isRotated())),c(2),b("ngClass",A(16,ae,!l.Informacion(),l.Informacion())),c(6),u("ngModel",l.marca_seleccionada),c(7),v(l.marca_seleccionada&&l.marca_seleccionada!="Falta"&&l.estab?52:l.marca_seleccionada&&l.marca_seleccionada==="Falta"?53:-1),c(2),v(l.marca_seleccionada!="Falta"?54:55),c(2),v(l.CargadaInformacion()?56:-1))},dependencies:[O,N,Z,J,Y,q,z,H,G,U,Q],styles:['@charset "UTF-8";.oculto[_ngcontent-%COMP%]{overflow:hidden;max-height:0px;padding:0;margin:0;transition:max-height .9s ease-out,padding .9s ease-out,margin 1s ease-out}.activo[_ngcontent-%COMP%]{overflow:hidden;max-height:1000px;transition:max-height .9s ease-out,padding .3s ease-out,margin .3s ease-out}.icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .3s ease}.icon.rotado[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:rotate(180deg)}']})};export{B as default};
